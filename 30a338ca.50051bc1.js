(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{130:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return w})),n.d(t,"metadata",(function(){return j})),n.d(t,"rightToc",(function(){return k})),n.d(t,"default",(function(){return C}));var r=n(3),o=n(7),i=n(0),a=n.n(i),c=n(155),u=n.p+"83a61083c7aea616438d47aceb16a3f7.jsx",s=(n(53),n(191)),d=n(179),l=n(162),f=n(141),p=n(153),h=n(156),m=function(){var e=Object(d.a)("speech",{tag:"div",content:0});return{type:"node",name:"speech",schema:{content:"inline*",group:"block",draggable:!1,toDOM:e.toDOM,parseDOM:e.parseDOM}}},b=function(){return[Object(p.b)({"Ctrl-d":g()}),h.c.createPlugin({name:"speech",containerDOM:["div",{class:"speech-container"}],contentDOM:["span",{class:"speech-text"}]})]};function v(){var e=Object(s.c)({specs:[].concat(Object(l.b)(),[m()]),plugins:function(){return[].concat(Object(l.a)(),[b()])},initialValue:{type:"doc",content:[{type:"paragraph",content:[{type:"text",text:"Let us play some sound \ud83c\udfb6"}]},{type:"speech",content:[{type:"text",text:"I am a robot"}]},{type:"paragraph",content:[{type:"text",text:"Press Ctrl-d to create more nodes"}]}]}});return a.a.createElement(s.a,{state:e,renderNodeViews:function(e){var t=e.node,n=e.updateAttrs,r=e.children;if("speech"===t.type.name)return a.a.createElement(O,{node:t,updateAttrs:n},r)}})}function g(e){return void 0===e&&(e="Hello !"),function(t,n){var r=t.schema.nodes.speech.createChecked(void 0,t.schema.text(e)),o=Object(f.p)(r,t.selection.from)(t.tr);return n&&n(o),!0}}function O(e){var t=e.node,n=e.children,r=Object(i.useState)(""),o=r[0],c=r[1],u=Object(i.useState)(speechSynthesis.getVoices()),s=u[0],d=u[1];return Object(i.useEffect)((function(){speechSynthesis.addEventListener&&speechSynthesis.addEventListener("voiceschanged",(function(){d(speechSynthesis.getVoices())}))}),[]),a.a.createElement("div",{style:{backgroundColor:"lightsteelblue",borderRadius:4,margin:"0.5rem 1rem",padding:"0.5rem 1rem"}},a.a.createElement("div",{className:"your-land",contentEditable:!1,style:{userSelect:"none"}},a.a.createElement("select",{value:o,onChange:function(e){c(e.target.value)}},s.map((function(e){return a.a.createElement("option",{key:e.name,value:e.lang},e.name," (",e.lang,")")}))),a.a.createElement("button",{onClick:function(){window.speechSynthesis.cancel();var e=new SpeechSynthesisUtterance(t.textContent);e.lang=o,speechSynthesis.speak(e)}},"Play")),n)}var y=n(193),w={title:"Custom Rendering"},j={unversionedId:"guides/custom-rendering-speech",id:"guides/custom-rendering-speech",isDocsHomePage:!1,title:"Custom Rendering",description:"Up untill this point you might be wondering what is the best way if you want",source:"@site/docs/guides/custom-rendering-speech.mdx",slug:"/guides/custom-rendering-speech",permalink:"/docs/guides/custom-rendering-speech",editUrl:"https://github.com/bangle-io/bangle.dev/edit/master/_bangle-website/docs/guides/custom-rendering-speech.mdx",version:"current",sidebar:"docs",previous:{title:"Your first Bangle Editor",permalink:"/docs/guides/first-editor"},next:{title:"Commands",permalink:"/docs/guides/commands"}},k=[{value:"Spec",id:"spec",children:[]},{value:"Plugins",id:"plugins",children:[]},{value:"Rendering",id:"rendering",children:[{value:"Wiring it all up",id:"wiring-it-all-up",children:[]}]}],M={rightToc:k};function C(e){var t=e.components,n=Object(o.a)(e,["components"]);return Object(c.b)("wrapper",Object(r.a)({},M,n,{components:t,mdxType:"MDXLayout"}),Object(c.b)("p",null,"Up untill this point you might be wondering what is the best way if you want\nto change the way a particular node is rendered in the browser. Bangle provides you with few options"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},"The simplest option is to look at the ",Object(c.b)("inlineCode",{parentName:"li"},"style.css")," of a component and override it with your own."),Object(c.b)("li",{parentName:"ul"},"If you only care about the HTML semantics you can modify the\n",Object(c.b)("a",Object(r.a)({parentName:"li"},{href:"https://prosemirror.net/docs/ref/#model.NodeSpec.toDOM"}),"toDOM")," and ",Object(c.b)("a",Object(r.a)({parentName:"li"},{href:"https://prosemirror.net/docs/ref/#model.NodeSpec.parseDOM"}),"parseDOM"),"\nin your ",Object(c.b)("a",Object(r.a)({parentName:"li"},{href:"/docs/api/core#spec"}),"spec.schema"),". Checkout this cute Prosemirror ",Object(c.b)("a",Object(r.a)({parentName:"li"},{href:"https://prosemirror.net/examples/dino/"}),"example")," for details."),Object(c.b)("li",{parentName:"ul"},"If you want all the bells and whistles read on \ud83d\ude0e!")),Object(c.b)("p",null,"In this guide we will create a component that speaks the words written inside of it with the help of the NodeView API."),Object(c.b)("p",null,"Below is the finished product:"),Object(c.b)(y.a,{filePath:u,language:"jsx",component:function(){return Object(c.b)(v,{mdxType:"Component"})},mdxType:"ReactCodeExample"}),Object(c.b)("h3",{id:"spec"},"Spec"),Object(c.b)("p",null,"We create a spec named ",Object(c.b)("inlineCode",{parentName:"p"},"speech")," having the following fields:"),Object(c.b)("pre",null,Object(c.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),"{\n  type: 'node',\n  name: 'speech',\n  schema: {\n    content: 'inline*',\n    group: 'block',\n    draggable: false,\n    toDOM,\n    parseDOM,\n  },\n}\n")),Object(c.b)("p",null,"The schema defines that this component can have 0 or more content of group ",Object(c.b)("inlineCode",{parentName:"p"},"inline"),"."),Object(c.b)("p",null,"Next we define the ",Object(c.b)("inlineCode",{parentName:"p"},"toDOM")," and ",Object(c.b)("inlineCode",{parentName:"p"},"parseDOM")," fields of the schema. They control how editor serializes and parses\nyour node. For node views, these fields dictate the exporting of HTML, copy pasting and dragging."),Object(c.b)("pre",null,Object(c.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),"const { toDOM, parseDOM } = domSerializationHelpers(name, {\n  tag: 'div',\n  content: 0,\n});\n")),Object(c.b)("p",null,"\ud83d\udca1 ",Object(c.b)("inlineCode",{parentName:"p"},"'0'")," in Prosemirror world is what ",Object(c.b)("inlineCode",{parentName:"p"},"props.children")," is in React i.e. dom content can be put in it. See ",Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://prosemirror.net/docs/ref/#model.DOMOutputSpec"}),"Proseemirror.DOMOutputSpec")," for more details"),Object(c.b)("p",null,"Since we donot really care about the semantics of the output, we use the helper function ",Object(c.b)("inlineCode",{parentName:"p"},"domSerializationHelpers"),"\nwhich generates a good enough pair of ",Object(c.b)("inlineCode",{parentName:"p"},"toDOM")," and ",Object(c.b)("inlineCode",{parentName:"p"},"parseDOM"),"."),Object(c.b)("p",null,"\ud83d\udcd6 Read the ",Object(c.b)("a",Object(r.a)({parentName:"p"},{href:"https://prosemirror.net/docs/guide/#schema"}),"Prosemirror.Schema")," guide if you want to dig deeper on what each of the fields in the schema mean."),Object(c.b)("h3",{id:"plugins"},"Plugins"),Object(c.b)("pre",null,Object(c.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),"plugins() {\n  return [\n    keymap({\n      'Ctrl-d': createSpeechNode(),\n    }),\n    ...\n  ];\n}\n")),Object(c.b)("p",null,"In the plugins, we define a keyboard shortcut which allows us to create a new speech node whenever\nuser presses ",Object(c.b)("inlineCode",{parentName:"p"},"Ctrl-d"),". Here, ",Object(c.b)("inlineCode",{parentName:"p"},"createSpeechNode()")," is a command which will insert a new ",Object(c.b)("inlineCode",{parentName:"p"},"speech")," node for us."),Object(c.b)("pre",null,Object(c.b)("code",Object(r.a)({parentName:"pre"},{className:"language-html"}),"<DOC>\n  || EDITOR LAND ||\n  <containerDOM>\n    || YOUR LAND ||\n    <contentDOM> || EDITOR LAND || </contentDOM>\n  </containerDOM>\n  || EDITOR LAND ||\n</DOC>\n")),Object(c.b)("h2",{id:"rendering"},"Rendering"),Object(c.b)("p",null,"Fully aborbing the visualization above, we create a React component:"),Object(c.b)("pre",null,Object(c.b)("code",Object(r.a)({parentName:"pre"},{className:"language-jsx"}),'<div>\n  <div className="your-land" contentEditable={false}>\n    <select\n      onChange={(e) => {\n        setLang(e.target.value);\n      }}\n    >\n      <option>some option</option>\n    </select>\n    <button onClick={onPlay}>Play</button>\n  </div>\n  {children}\n</div>\n')),Object(c.b)("p",null,"We put all our customization under the div ",Object(c.b)("inlineCode",{parentName:"p"},".your-land"),". Bangle will automatically insert ",Object(c.b)("inlineCode",{parentName:"p"},"contentDOM")," in the ",Object(c.b)("inlineCode",{parentName:"p"},"children")," to allow for typing in our speech component."),Object(c.b)("p",null,"As you notice we have marked just a part of the UI as ",Object(c.b)("inlineCode",{parentName:"p"},"contentEditable=false"),", this\ntells the browser that unlike the rest, this content is not meant to be editable."),Object(c.b)("p",null,"\ud83d\udca1 When creating NodeView UI make sure that all the dom\nancestors of ",Object(c.b)("inlineCode",{parentName:"p"},"{children}")," are free of ",Object(c.b)("inlineCode",{parentName:"p"},"contentEditable=true")," or ",Object(c.b)("inlineCode",{parentName:"p"},"contentEditable=false"),". This helps prevent\n",Object(c.b)("inlineCode",{parentName:"p"},"contentEditable")," islands, which hamper the free flow of the cursor in your document. Like the example above, tuck\nall the custom UI in a single ",Object(c.b)("inlineCode",{parentName:"p"},"div")," or ",Object(c.b)("inlineCode",{parentName:"p"},"span"),"."),Object(c.b)("pre",null,Object(c.b)("code",Object(r.a)({parentName:"pre"},{className:"language-jsx"}),'// \ud83d\udeab donot do this as it creates `contentEditable` islands\n<div contentEditable={true}>\n  <div className="your-land" contentEditable={false}>\n    <button onClick={onPlay}>Play</button>\n  </div>\n  {children}\n</div>\n\n// \ud83d\udeab donot do this as it creates `contentEditable` islands\n<div contentEditable={true}>\n  <div className="your-land" contentEditable={false}>\n    <button onClick={onPlay}>Play</button>\n    <div contentEditable={true}>\n      {children}\n    </div>\n  </div>\n</div>\n\n// \ud83d\udc4d this is good\n<div>\n  <div className="your-land" contentEditable={false}>\n    <button onClick={onPlay}>Play</button>\n  </div>\n  <div>\n   {children}\n  </div>\n</div>\n')),Object(c.b)("h3",{id:"wiring-it-all-up"},"Wiring it all up"),Object(c.b)("p",null,"In your React component we expect a render prop which will be called whenever\nthere is an update for any of your node view and based on the type of your node\nyou can decide what component to render."),Object(c.b)("pre",null,Object(c.b)("code",Object(r.a)({parentName:"pre"},{className:"language-jsx"}),"<BangleEditor\n  state={editorState}\n  renderNodeViews={({ node, updateAttrs, children }) => {\n    if (node.type.name === 'speech') {\n      return (\n        <Speech node={node} updateAttrs={updateAttrs}>\n          {children}\n        </Speech>\n      );\n    }\n  }}\n/>\n")),Object(c.b)("p",null,"In the second plugin, we tell Bangle to use a NodeView plugin for rendering the ",Object(c.b)("inlineCode",{parentName:"p"},"speech")," node. With this\nwe are on our own on deciding the rendering of this node."),Object(c.b)("p",null,"The ",Object(c.b)("inlineCode",{parentName:"p"},"contentDOM")," and ",Object(c.b)("inlineCode",{parentName:"p"},"containerDOM")," are names you will hear often in the docs:"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},Object(c.b)("p",{parentName:"li"},Object(c.b)("inlineCode",{parentName:"p"},"contentDOM"),": Is the dom node which will be the parent of the content. As you know, in our spec\nwe defined our node to have any content which is of the group ",Object(c.b)("inlineCode",{parentName:"p"},"inline"),". So anything that you type\nin the speech node, will be directly housed by this dom node.")),Object(c.b)("li",{parentName:"ul"},Object(c.b)("p",{parentName:"li"},Object(c.b)("inlineCode",{parentName:"p"},"containerDOM"),": This is the outermost node of ",Object(c.b)("inlineCode",{parentName:"p"},"speech")," node."))),Object(c.b)("p",null,"The bangle editor will directly interface with these two nodes and leave the things in between for you.\nYou can visualize this relationship something like this,\nwhere you only control the part demarcated as ",Object(c.b)("inlineCode",{parentName:"p"},"YOUR LAND"),"."),Object(c.b)("pre",null,Object(c.b)("code",Object(r.a)({parentName:"pre"},{className:"language-js"}),"NodeView.createPlugin({\n  name: 'speech',\n  // The speech component will be mounted on this\n  containerDOM: ['div', { class: 'speech-container' }],\n  // The dom.Node which Bangle will control to allow for typing of things to speak.\n  contentDOM: ['span', { class: 'speech-text' }],\n});\n")))}C.isMDXComponent=!0},141:function(e,t,n){"use strict";n.d(t,"p",(function(){return c})),n.d(t,"d",(function(){return u})),n.d(t,"k",(function(){return s})),n.d(t,"t",(function(){return d})),n.d(t,"s",(function(){return l})),n.d(t,"f",(function(){return f})),n.d(t,"g",(function(){return p})),n.d(t,"l",(function(){return h})),n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return v})),n.d(t,"m",(function(){return g})),n.d(t,"i",(function(){return O})),n.d(t,"q",(function(){return y})),n.d(t,"e",(function(){return w})),n.d(t,"n",(function(){return j})),n.d(t,"j",(function(){return k})),n.d(t,"o",(function(){return M})),n.d(t,"h",(function(){return S})),n.d(t,"c",(function(){return A})),n.d(t,"u",(function(){return D})),n.d(t,"r",(function(){return E}));var r=n(157),o=n(144),i=n(181),a=n(148);function c(){return r.safeInsert.apply(void 0,arguments)}var u=r.findParentNodeOfType;function s(e){return function(t){var n=t.selection,r=n.from,o=n.$from,i=n.to;return n.empty?Boolean(e.isInSet(t.tr.storedMarks||o.marks())):Boolean(t.doc.rangeHasMark(r,i,e))}}var d=function(e,t){return Number.isInteger(e)&&e>=0&&e<t.content.size},l=function(e,t){return[t.bulletList,t.orderedList].includes(e)};function f(e,t){var n=e.selection,r=n.from,o=n.to,i=[];e.doc.nodesBetween(r,o,(function(e){i=[].concat(i,e.marks)}));var a=i.find((function(e){return e.type.name===t.name}));return a?a.attrs:{}}function p(e){var t;if(e.isInline)return(t=e).isText?!!t.textContent.trim():"hardBreak"!==t.type.name;if(e.isBlock&&(e.isLeaf||e.isAtom))return!0;if(!e.childCount)return!1;for(var n=0;n<e.childCount;n++){if(p(e.child(n)))return!0}return!1}function h(e){if(e&&e.textContent)return!1;if(!e||!e.childCount||1===e.childCount&&m(e.firstChild))return!0;var t=[],n=[];return e.forEach((function(e){e.isInline?n.push(e):t.push(e)})),!n.length&&!t.filter((function(e){return!!e.childCount&&!(1===e.childCount&&m(e.firstChild))||e.isAtom})).length}function m(e){return!e||"paragraph"===e.type.name&&!e.textContent&&!e.childCount}function b(e,t){return function(n,r,o){return Array.isArray(e)||(e=[e]),!e.some((function(e){return!e(n,o)}))&&(t(n,r,o)||!1)}}function v(e){if(!e.parent.type.spec.isolating)for(var t=e.depth-1;t>=0;t--){if(e.index(t)>0)return e.doc.resolve(e.before(t+1));if(e.node(t).type.spec.isolating)break}return null}function g(e,t,n,r){return 0===function(e,t,n){var r=[],o=function(e,t){var n=["blockquote","bulletList","orderedList"];if(1===t.depth)return t;var r=t.node(t.depth),o=t;for(;t.depth>=1;)(r=(t=e.resolve(t.before(t.depth))).node(t.depth))&&-1!==n.indexOf(r.type.name)&&(o=t);return o}(e,t).depth,i=e.resolve(t.start(o));for(;i.pos<=n.start(n.depth);){var a=Math.min(i.depth,o),c=i.node(a);if(c&&r.push(c),0===a)break;var u=e.resolve(i.after(a));if(u.start(a)>=e.nodeSize-2)break;u.depth!==i.depth&&(u=e.resolve(u.pos+2)),i=u.depth?e.resolve(u.start(u.depth)):e.resolve(u.end(u.depth))}return r}(e,t,n).filter((function(e){return e.type!==r})).length}var O=function(e){var t=e.selection,n=t.empty,r=t.$from;return n&&(0===r.parentOffset||e.selection instanceof i.a)},y=function(e,t){var n,r=e.tr.selection,o=r.from,i=r.to;return e.doc.nodesBetween(o,i,(function(r,a,c){if(r.isText||a<o||a>i)return!0;r.marks.forEach((function(o){if(!c.type.allowsMarkType(o.type)||t&&!t.allowsMarkType(o.type)){var i=r.marks.filter((function(e){return e.type!==o.type})),u=a>0?a-1:0,s=e.doc.nodeAt(u);if(!s||s.isText)return;n=(n||e.tr).setNodeMarkup(u,void 0,r.attrs,i)}}))}),o),n},w=function(e,t,n){var r=n.depth,o=t.nodes,i=o.bulletList,a=o.orderedList,c=e;c||(c=t.nodes.listItem);for(var u=n.depth;u>0;u--){var s=n.node(u);if(s.type!==i&&s.type!==a||(r=u),s.type!==i&&s.type!==a&&s.type!==c)break}return r-1};function j(e,t){for(var n=[],r=0;r<e.childCount;r++)n.push(t(e.child(r),r,e instanceof o.Fragment?e:e.content));return n}var k=function(e){var t=e.selection.$from;return!(t.depth>1)||(e.selection instanceof i.a&&0===t.parentOffset||0===t.index(t.depth-1))};function M(e,t){var n=C(e.content,t);return new o.Slice(n,e.openStart,e.openEnd)}function C(e,t,n){for(var r=[],i=0,a=e.childCount;i<a;i++){var c=e.child(i),u=c.isLeaf?t(c,n,i):t(c.copy(C(c.content,t,c)),n,i);u&&(u instanceof o.Fragment?r.push.apply(r,u.content):Array.isArray(u)?r.push.apply(r,u):r.push(u))}return o.Fragment.fromArray(r)}function S(e,t,n,r){void 0===t&&(t="above"),void 0===n&&(n=!1);var o="above"===t,i=n?-1:void 0;return function(t,n){var a=o?t.selection.$from.before(i):t.selection.$from.after(i),u=e.createAndFill(r),s=t.tr,d=c(u,a)(t.tr);return s!==d&&(n&&n(d.scrollIntoView()),!0)}}function A(e,t,n,r){var o={start:-1,end:-1};return t.nodesBetween(n,r,(function(t,n){if(o.start>-1)return!1;-1===o.start&&e.isInSet(t.marks)&&(o={start:n,end:n+Math.max(t.textContent.length,1)})})),o}function D(e,t){return new a.a({key:e,state:{init:function(){return t},apply:function(e,t){return t}}})}function E(e){var t=document.createElement("div"),n=o.DOMSerializer.fromSchema(e.schema).serializeFragment(e.doc.content);return t.appendChild(n),t.innerHTML}},146:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"c",(function(){return a})),n.d(t,"e",(function(){return c})),n.d(t,"g",(function(){return u})),n.d(t,"f",(function(){return s})),n.d(t,"i",(function(){return d})),n.d(t,"b",(function(){return l})),n.d(t,"d",(function(){return f})),n.d(t,"h",(function(){return p}));n(188),n(189);var r=n(144),o=n(159);function i(e){if(null==e)throw new Error("undefined value passed");return Array.isArray(e)?e:[e]}function a(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var o=[e].concat(n);return function(e){return o.reduceRight((function(e,t){return t(e)}),e)}}function c(e,t){var n=[].concat(t.matchAll(e));if(0===n.length)return[{start:0,end:t.length,match:!1,subString:t}];for(var r=[],o=0,i=0;i<n.length;i++){var a=n[i],c=a.index,u=c+a[0].length;o!==c&&r.push({start:o,end:c,match:!1}),r.push({start:c,end:u,match:!0}),o=u}var s=r[r.length-1]&&r[r.length-1].end;return s&&s!==t.length&&r.push({start:s,end:t.length,match:!1}),r=r.map((function(e){return Object.assign({},e,{subString:t.slice(e.start,e.end)})}))}function u(e,t){return Object.fromEntries(Object.entries(e).map((function(e){var n=e[0],r=e[1];return[n,t(r,n)]})))}function s(e,t){return Object.fromEntries(Object.entries(e).filter((function(e){var n=e[0],r=e[1];return t(r,n)})))}function d(e){var t=[],n=null,r=function(){for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];t=o,n||(n=requestAnimationFrame((function(){n=null,e.apply(void 0,t)})))};return r.cancel=function(){n&&(cancelAnimationFrame(n),n=null)},r}var l=o.b||o.a?function(){}:console.warn.bind(console,"Warning in bangle.js:");function f(e){var t=r.DOMSerializer.renderSpec(window.document,e),n=t.dom;if(t.contentDOM)throw new Error("createElement does not support creating contentDOM");return n}function p(e,t){requestAnimationFrame((function(){t(e.state,e.dispatch,e)}))}},148:function(e,t,n){"use strict";n.d(t,"b",(function(){return o}));var r=n(142);n.d(t,"a",(function(){return r.Plugin})),n.d(t,"c",(function(){return r.PluginKey}));var o=function(e,t){this.name=e,this.plugins=t}},149:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return d})),n.d(t,"d",(function(){return l})),n.d(t,"c",(function(){return f})),n.d(t,"e",(function(){return p}));var r=n(157),o=n(142),i=n(146),a=n(141),c=n(144),u=n(169);function s(e){return function(t,n,i){if(!t.selection.empty)return!1;var a=Object(r.findParentNodeOfType)(e)(t.selection);if(!a)return!1;var c=t.selection,u=t.tr;u=u.setSelection(function(e,t){var n=e.selection.$from,r=n.start(t),i=n.end(t);return o.TextSelection.create(e.doc,r,i)}(t,a.depth)),n&&n(u),document.execCommand("copy");var s=i.state.tr;return n&&n(s.setSelection(o.Selection.near(s.doc.resolve(c.$from.pos)))),!0}}function d(e){return function(t,n){if(!t.selection.empty)return!1;var i=Object(r.findParentNodeOfType)(e)(t.selection);if(!i||!i.node)return!1;var a=t.tr;return a=a.setSelection(o.NodeSelection.create(a.doc,i.pos)),n&&n(a),document.execCommand("cut"),!0}}function l(e,t){return t=Object(i.a)(t),function(n){var o=Object(r.findParentNodeOfType)(e)(n.selection);if(!o)return!1;var i=o.depth-1;if(i<0)return!1;var a=n.selection.$from.node(i);return t.includes(a.type)}}function f(e,t){void 0===t&&(t="UP");var n="DOWN"===t;return function(t,i){if(!t.selection.empty)return!1;var s=t.selection.$from,d=Object(r.findParentNodeOfType)(e)(t.selection);if(!d)return!1;var l=d.node,f=d.depth-1,p=s.node(f),h=s.start(f);if(l.type!==e)return!1;var m=Object(a.n)(p,(function(e){return e})),b=m.indexOf(l),v=n?b+1:b-1;if(v>=m.length||v<0)return!1;var g=m[v].nodeSize,O=[m[v],m[b]];m[b]=O[0],m[v]=O[1];var y=t.tr,w=h,j=s.end(f),k=new c.Slice(c.Fragment.fromArray(m),0,0);return y=(y=y.step(new u.c(w,j,k,!1))).setSelection(o.Selection.near(y.doc.resolve(n?s.pos+g:s.pos-g))),i&&i(y.scrollIntoView()),!0}}var p=function(e){return function(t,n,r){var i=e.nodeSize-1;"doc"===e.type.name&&(i=e.content.size-1);var a=t.tr.setSelection(o.TextSelection.create(t.doc,i));return n&&n(a),!0}}},150:function(e,t,n){"use strict";n.d(t,"b",(function(){return u}));var r={mac:!1,ie:!1,ie_version:0,gecko:!1,chrome:!1,chrome_version:0,android:!1,ios:!1,webkit:!1};if("undefined"!=typeof navigator){var o=/Edge\/(\d+)/.exec(navigator.userAgent),i=/MSIE \d/.test(navigator.userAgent),a=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);r.mac=/Mac/.test(navigator.platform);var c=r.ie=!!(i||a||o);r.ie_version=i?document.documentMode||6:a?+a[1]:o?+o[1]:null,r.gecko=!c&&/gecko\/\d/i.test(navigator.userAgent),r.chrome=!c&&/Chrome\//.test(navigator.userAgent),r.chrome_version=parseInt((navigator.userAgent.match(/Chrome\/(\d{2})/)||[])[1],10),r.android=/Android \d/.test(navigator.userAgent),r.ios=!c&&/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),r.webkit=!c&&!!document.documentElement&&"WebkitAppearance"in document.documentElement.style}t.a=r;var u=r.chrome&&!r.android&&r.chrome_version>=58},151:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(147);function o(e,t){return new r.a(e,(function(e,n,r,o){var i=e.tr,a=n.length-1,c=o,u=r;if(n[a]){var s=r+n[0].indexOf(n[a-1]),d=s+n[a-1].length-1,l=s+n[a-1].lastIndexOf(n[a]),f=l+n[a].length;if(function(e,t,n){var r=[];return n.doc.nodesBetween(e,t,(function(e,t){r=[].concat(r,e.marks.map((function(n){return{start:t,end:t+e.nodeSize,mark:n}})))})),r}(r,o,e).filter((function(e){return e.mark.type.excluded.find((function(e){return e.name===t.name}))})).filter((function(e){return e.end>s})).length)return!1;f<d&&i.delete(f,d),l>s&&i.delete(s,l),c=(u=s)+n[a].length}return i.addMark(u,c,t.create()),i.removeStoredMark(t),i}))}},152:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(142),o=n(144);function i(e,t,n){var i=function r(i,a){var c=[];return i.forEach((function(o){if(o.isText){for(var i,u=o.text,s=0,d=!!o.marks.filter((function(e){return"link"===e.type.name}))[0];!d&&null!==(i=e.exec(u));)if(a&&a.type.allowsMarkType(t)&&i[1]){var l=i.index,f=l+i[0].length,p=l+i[0].indexOf(i[1]),h=p+i[1].length,m=n instanceof Function?n(i):n;l>0&&c.push(o.cut(s,l)),c.push(o.cut(p,h).mark(t.create(m).addToSet(o.marks))),s=f}s<u.length&&c.push(o.cut(s))}else c.push(o.copy(r(o.content,o)))})),o.Fragment.fromArray(c)};return new r.Plugin({props:{transformPasted:function(e){return new o.Slice(i(e.content),e.openStart,e.openEnd)}}})}},153:function(e,t,n){"use strict";n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return c}));var r=n(145),o="undefined"==typeof window||window.BANGLE_DEBUG_KEYBINDINGS,i=new WeakMap;function a(e,t){var n=(void 0===t?{}:t).monitor,a=void 0===n?o:n,c=Object.entries(e).flatMap((function(e){var t=e[0],n=e[1];return t&&"undefined"!==t&&"null"!==t&&"false"!==t?t.split(" ").map((function(e){return[e,n]})):[]})).filter((function(e){e[0];return null!=e[1]})),u=Object.fromEntries(c),s=Object(r.b)(u);return a&&i.set(s,u),s}function c(){return a.apply(void 0,arguments)}},154:function(e,t,n){"use strict";n.d(t,"b",(function(){return h})),n.d(t,"d",(function(){return m})),n.d(t,"m",(function(){return b})),n.d(t,"n",(function(){return v})),n.d(t,"r",(function(){return r})),n.d(t,"t",(function(){return o})),n.d(t,"f",(function(){return i})),n.d(t,"q",(function(){return _})),n.d(t,"s",(function(){return a})),n.d(t,"a",(function(){return q})),n.d(t,"c",(function(){return R})),n.d(t,"e",(function(){return c})),n.d(t,"h",(function(){return u})),n.d(t,"i",(function(){return te})),n.d(t,"k",(function(){return s})),n.d(t,"o",(function(){return d})),n.d(t,"p",(function(){return ge})),n.d(t,"l",(function(){return l})),n.d(t,"j",(function(){return f})),n.d(t,"g",(function(){return p}));var r={};n.r(r),n.d(r,"spec",(function(){return k})),n.d(r,"plugins",(function(){return M})),n.d(r,"commands",(function(){return C})),n.d(r,"defaultKeys",(function(){return S})),n.d(r,"toggleStrike",(function(){return D})),n.d(r,"queryIsStrikeActive",(function(){return E}));var o={};n.r(o),n.d(o,"spec",(function(){return N})),n.d(o,"plugins",(function(){return I})),n.d(o,"commands",(function(){return x})),n.d(o,"defaultKeys",(function(){return P})),n.d(o,"toggleUnderline",(function(){return B})),n.d(o,"queryIsUnderlineActive",(function(){return L}));var i={};n.r(i),n.d(i,"spec",(function(){return $}));var a={};n.r(a),n.d(a,"spec",(function(){return V}));var c={};n.r(c),n.d(c,"spec",(function(){return U})),n.d(c,"plugins",(function(){return W})),n.d(c,"commands",(function(){return F})),n.d(c,"defaultKeys",(function(){return K})),n.d(c,"queryIsCodeActiveBlock",(function(){return Y}));var u={};n.r(u),n.d(u,"spec",(function(){return Z})),n.d(u,"plugins",(function(){return X})),n.d(u,"defaultKeys",(function(){return Q}));var s={};n.r(s),n.d(s,"spec",(function(){return ne})),n.d(s,"plugins",(function(){return re}));var d={};n.r(d),n.d(d,"spec",(function(){return de})),n.d(d,"plugins",(function(){return le})),n.d(d,"commands",(function(){return fe})),n.d(d,"defaultKeys",(function(){return pe})),n.d(d,"indentListItem",(function(){return be})),n.d(d,"outdentListItem",(function(){return ve}));var l={};n.r(l),n.d(l,"spec",(function(){return Ce})),n.d(l,"plugins",(function(){return Se})),n.d(l,"commands",(function(){return Ae})),n.d(l,"updateImageNodeAttribute",(function(){return Te}));var f={};n.r(f),n.d(f,"plugins",(function(){return _e})),n.d(f,"commands",(function(){return Ve})),n.d(f,"defaultKeys",(function(){return qe})),n.d(f,"undo",(function(){return Re})),n.d(f,"redo",(function(){return ze}));var p={};n.r(p),n.d(p,"plugins",(function(){return Ue})),n.d(p,"docChangedKey",(function(){return We})),n.d(p,"selectionChangedKey",(function(){return Fe}));var h=n(172),m=n(173),b=n(174),v=n(168),g=n(151),O=n(152),y=n(143),w=n(145),j=n(141),k=function(e){void 0===e&&(e={});return{type:"mark",name:A,schema:{parseDOM:[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",getAttrs:function(e){return"line-through"===e}}],toDOM:function(){return["s",0]}},markdown:{toMarkdown:{open:"~~",close:"~~",mixable:!0,expelEnclosingWhitespace:!0},parseMarkdown:{s:{mark:"strike"}}}}},M=function(e){var t=(void 0===e?{}:e).keybindings,n=void 0===t?S:t;return function(e){var t,r=function(e){return e.marks.strike}(e.schema);return[Object(O.a)(/~([^~]+)~/g,r),Object(g.a)(/~([^~]+)~$/,r),n&&Object(w.b)((t={},t[n.toggleStrike]=Object(y.f)(r),t))]}},C={toggleStrike:D,queryIsStrikeActive:E},S={toggleStrike:"Mod-d"},A="strike";function D(){return function(e,t,n){return Object(y.f)(e.schema.marks.strike)(e,t,n)}}function E(){return function(e){return Object(j.k)(e.schema.marks.strike)(e)}}var N=function(e){void 0===e&&(e={});return{type:"mark",name:T,schema:{parseDOM:[{tag:"u"},{style:"text-decoration",getAttrs:function(e){return e===T}}],toDOM:function(){return["u",0]}},markdown:{toMarkdown:{open:"_",close:"_",mixable:!0,expelEnclosingWhitespace:!0}}}},I=function(e){var t=(void 0===e?{}:e).keybindings,n=void 0===t?P:t;return function(e){var t,r=function(e){return e.marks.underline}(e.schema);return[Object(g.a)(/~([^~]+)~$/,r),Object(O.a)(/~([^~]+)~/g,r),n&&Object(w.b)((t={},t[n.toggleUnderline]=Object(y.f)(r),t))]}},x={toggleUnderline:B,queryIsUnderlineActive:L},P={toggleUnderline:"Mod-u"},T="underline";function B(){return function(e,t,n){return Object(y.f)(e.schema.marks.underline)(e,t,n)}}function L(){return function(e){return Object(j.k)(e.schema.marks.underline)(e)}}var $=function(e){var t=(void 0===e?{}:e).content;return{type:"node",topNode:!0,name:"doc",schema:{content:void 0===t?"block+":t}}};var _=n(175),V=function(e){void 0===e&&(e={});return{type:"node",name:"text",schema:{group:"inline"},markdown:{toMarkdown:function(e,t){e.text(t.text)}}}};var q=n(176),R=n(177),z=n(147),H=n(149),U=function(e){void 0===e&&(e={});return{type:"node",name:J,schema:{attrs:{language:{default:""}},content:"text*",marks:"",group:"block",code:!0,defining:!0,draggable:!1,parseDOM:[{tag:"pre",preserveWhitespace:"full"}],toDOM:function(){return["pre",["code",0]]}},markdown:{toMarkdown:function(e,t){e.write("```"+(t.attrs.language||"")+"\n"),e.text(t.textContent,!1),e.ensureNewLine(),e.write("```"),e.closeBlock(t)},parseMarkdown:{code_block:{block:J,noCloseToken:!0},fence:{block:J,getAttrs:function(e){return{language:e.info||""}},noCloseToken:!0}}}}},W=function(e){var t=void 0===e?{}:e,n=t.markdownShortcut,r=void 0===n||n,o=t.keybindings,i=void 0===o?K:o;return function(e){var t,n=e.schema,o=G(n);return[r&&Object(z.c)(/^```$/,o),i&&Object(w.b)((t={},t[i.toCodeBlock]=Object(y.e)(o),t[i.moveUp]=Object(H.c)(o,"UP"),t[i.moveDown]=Object(H.c)(o,"DOWN"),t[i.insertEmptyParaAbove]=Object(j.a)(Y(),Object(j.h)(n.nodes.paragraph,"above",!1)),t[i.insertEmptyParaBelow]=Object(j.a)(Y(),Object(j.h)(n.nodes.paragraph,"below",!1)),t))]}},F={queryIsCodeActiveBlock:Y},K={toCodeBlock:"Shift-Ctrl-\\",moveDown:"Alt-ArrowDown",moveUp:"Alt-ArrowUp",insertEmptyParaAbove:"Mod-Shift-Enter",insertEmptyParaBelow:"Mod-Enter"},J="codeBlock",G=function(e){return e.nodes.codeBlock};function Y(){return function(e){var t=G(e.schema);return Boolean(Object(j.d)(t)(e.selection))}}var Z=function(e){void 0===e&&(e={});return{type:"node",name:ee,schema:{inline:!0,group:"inline",selectable:!1,parseDOM:[{tag:"br"}],toDOM:function(){return["br"]}},markdown:{toMarkdown:function(e,t,n,r){for(var o=r+1;o<n.childCount;o++)if(n.child(o).type!==t.type)return void e.write("\\\n")},parseMarkdown:{hardbreak:{node:"hardBreak"}}}}},X=function(e){var t=(void 0===e?{}:e).keybindings,n=void 0===t?Q:t;return function(e){var t,r=function(e){return e.nodes[ee]}(e.schema),o=Object(y.c)(y.d,(function(e,t){return t&&t(e.tr.replaceSelectionWith(r.create()).scrollIntoView()),!0}));return[n&&Object(w.b)((t={},t[n.insert]=o,t))]}},Q={insert:"Shift-Enter"},ee="hardBreak";var te=n(171),ne=function(e){void 0===e&&(e={});return{type:"node",name:oe,schema:{group:"block",parseDOM:[{tag:"hr"}],toDOM:function(){return["hr"]}},markdown:{toMarkdown:function(e,t){e.write(t.attrs.markup||"---"),e.closeBlock(t)},parseMarkdown:{hr:{node:oe}}}}},re=function(e){var t=(void 0===e?{}:e).markdownShortcut,n=void 0===t||t;return function(e){var t=function(e){return e.nodes.horizontalRule}(e.schema);return[n&&new z.a(/^(?:---|___\s|\*\*\*\s)$/,(function(e,n,r,o){if(!n[0])return null;var i=e.tr.replaceWith(r-1,o,t.createChecked());return Object(j.p)(e.schema.nodes.paragraph.createChecked(),i.selection.end)(i)}))]}},oe="horizontalRule";var ie=n(160),ae=n(167),ce=n(165),ue=n(150),se=function(){},de=function(e){void 0===e&&(e={});var t=Object(ce.b)(he,{tag:"li",content:0}),n=t.toDOM,r=t.parseDOM;return{type:"node",name:he,schema:{content:"(paragraph) (paragraph | bulletList | orderedList)*",defining:!0,draggable:!0,attrs:{todoChecked:{default:null}},toDOM:n,parseDOM:r},markdown:{toMarkdown:function(e,t){null!=t.attrs.todoChecked&&e.write(t.attrs.todoChecked?"[x] ":"[ ] "),e.renderContent(t)},parseMarkdown:{list_item:{block:he,getAttrs:function(e){return{todoChecked:e.attrGet("isDone")}}}}}}},le=function(e){var t=void 0===e?{}:e,n=t.keybindings,r=void 0===n?pe:n,o=t.nodeView,i=void 0===o||o;return function(e){var t,n,o,a,c=e.schema,u=me(c),s=Object(H.d)(u,[c.nodes.bulletList,c.nodes.orderedList]),d=function(e){return Object(ae.d)(e.selection.$from.node(-1),e.schema)},l=function(e){return Object(y.c)(Object(H.c)(u,e),(function(t,n,r){var o=t.selection.$from.node(-3),i=Object(ae.d)(o,t.schema);if(!Object(ae.e)(u,e)(t,n,r))return!1;if(i&&n){var a=r.state;n(a.tr.setNodeMarkup(a.selection.$from.before(-1),void 0,Object.assign({},o.attrs,{todoChecked:!1})))}return!0}))};return[r&&Object(w.b)((t={},t[r.toggleDone]=Object(j.a)(s,Object(ae.h)(c.nodes.listItem,(function(e){return Object.assign({},e,{todoChecked:null!=e.todoChecked&&!e.todoChecked})}))),t.Backspace=Object(ae.a)(u),t.Enter=Object(ae.b)(u),t[r.indent]=be(),t[r.outdent]=ve(),t[r.moveUp]=Object(j.a)(s,l("UP")),t[r.moveDown]=Object(j.a)(s,l("DOWN")),t[r.emptyCut]=Object(j.a)(s,Object(H.b)(u)),t[r.emptyCopy]=Object(j.a)(s,Object(H.a)(u)),t[r.insertEmptyListAbove]=Object(y.c)(Object(j.a)(d,Object(j.h)(u,"above",!0,{todoChecked:!1})),Object(j.a)(s,Object(j.h)(u,"above",!0))),t[r.insertEmptyListBelow]=Object(y.c)(Object(j.a)(d,Object(j.h)(u,"below",!0,{todoChecked:!1})),Object(j.a)(s,Object(j.h)(u,"below",!0))),t)),i&&(n=function(e,t){return"bulletList"===e.doc.resolve(t).parent.type.name},function(e){e.containerDOM.hasAttribute("data-bangle-is-todo")&&(e.containerDOM.removeAttribute("data-bangle-is-todo"),e.containerDOM.removeChild(e.containerDOM.firstChild))},o=function(e,t,n){if(!n.containerDOM.hasAttribute("data-bangle-is-todo")){var r=a(e.todoChecked,(function(e){t({todoChecked:e})}));n.containerDOM.setAttribute("data-bangle-is-todo",""),n.containerDOM.prepend(r)}},a=function(e,t){var n=Object(ce.a)(["span",{contentEditable:!1},["input",{type:"checkbox"}]]),r=n.querySelector("input");return e&&r.setAttribute("checked",""),r.addEventListener("input",(function(e){se("change event",r.checked),t(r.checked)})),n},ie.a.createPlugin({name:he,containerDOM:["li",{"data-bangle-name":he}],contentDOM:["span",{}],renderHandlers:{create:function(e,t){var r=t.attrs,i=t.updateAttrs,a=t.getPos,c=t.view,u=r.todoChecked;null!=u&&n(c.state,a())&&o(r,i,e),e.containerDOM.appendChild(e.contentDOM)},update:function(e,t){var r=t.attrs,i=t.view,a=t.getPos,c=t.updateAttrs,u=r.todoChecked;if(null!=u){if(n(i.state,a())){o(r,c,e);var s=e.containerDOM.firstChild.firstChild,d=s.hasAttribute("checked");u!==d?(se("updating inputElement"),u?s.setAttribute("checked","true"):s.removeAttribute("checked")):se("skipping update",u,d)}}else!function(e){if(!e.containerDOM.hasAttribute("data-bangle-is-todo"))return;e.containerDOM.removeAttribute("data-bangle-is-todo"),e.containerDOM.removeChild(e.containerDOM.firstChild)}(e)},destroy:function(){}}}))]}},fe={indentListItem:be,outdentListItem:ve},pe={toggleDone:ue.a.mac?"Ctrl-Enter":"Ctrl-I",indent:"Tab",outdent:"Shift-Tab",moveDown:"Alt-ArrowDown",moveUp:"Alt-ArrowUp",emptyCopy:"Mod-c",emptyCut:"Mod-x",insertEmptyListAbove:"Mod-Shift-Enter",insertEmptyListBelow:"Mod-Enter"},he="listItem",me=function(e){return e.nodes.listItem};function be(){return function(e,t,n){var r=me(e.schema);return Object(ae.c)(r)(e,t,n)}}function ve(){return function(e,t,n){var r=me(e.schema);return Object(ae.f)(r)(e,t,n)}}var ge=n(178),Oe=n(188),ye=n.n(Oe),we=n(164),je=n(189),ke=n(142),Me=n(157),Ce=function(e){void 0===e&&(e={});return{type:"node",name:De,schema:{inline:!0,attrs:{src:{},alt:{default:null},title:{default:null}},group:"inline",draggable:!0,parseDOM:[{tag:"img[src]",getAttrs:function(e){return{src:e.getAttribute("src"),title:e.getAttribute("title"),alt:e.getAttribute("alt")}}}],toDOM:function(e){return["img",e.attrs]}},markdown:{toMarkdown:function(e,t){var n=e.esc(t.attrs.alt||""),r=e.esc(t.attrs.src)+(t.attrs.title?" "+e.quote(t.attrs.title):"");e.write("!["+n+"]("+r+")")},parseMarkdown:{image:{node:De,getAttrs:function(e){return{src:e.attrGet("src"),title:e.attrGet("title")||null,alt:e.children[0]&&e.children[0].content||null}}}}}}},Se=function(e){var t=void 0===e?{}:e,n=t.handleDragAndDrop,r=void 0===n||n;t.keybindings;return function(e){var t=e.schema,n=Ee(t);return[new z.a(/!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\)/,(function(e,t,r,o){var i=t[1],a=t[2],c=t[3];if(a)return c||(c=i),e.tr.replaceWith(r,o,n.create({src:a,alt:i,title:c}))})),r&&new ke.Plugin({key:new ke.PluginKey("image-drop-paste"),props:{handleDOMEvents:{drop:function(e,t){if(null==t.dataTransfer)return!1;var n=Pe(t.dataTransfer,"image/*",!0);if(!n||0===n.length)return!1;t.preventDefault();var r=e.posAtCoords({left:t.clientX,top:t.clientY});return Ne(e,null==r?void 0:r.pos,n.map((function(e){return xe(e)}))),!0}},handlePaste:function(e,t,n){var r=t;if(!r.clipboardData)return!1;var o=Pe(r.clipboardData,"image/*",!0);return!(!o||0===o.length)&&(Ne(e,e.state.selection.from,o.map((function(e){return xe(e)}))).catch((function(e){return console.error(e)})),!0)}}})]}},Ae={},De="image",Ee=function(e){return e.nodes.image};function Ne(e,t,n){return Ie.apply(this,arguments)}function Ie(){return(Ie=Object(je.a)(ye.a.mark((function e(t,n,r){var o,i,a,c,u,s,d;return ye.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=Object(we.a)(r);case 1:if((i=o()).done){e.next=14;break}return a=i.value,e.next=5,a;case 5:if(c=e.sent,u=Ee(t.state.schema).create({src:c}),s=t.state.tr,(d=Object(Me.safeInsert)(u,n)(s))!==s){e.next=11;break}return e.abrupt("continue",12);case 11:t.dispatch(d);case 12:e.next=1;break;case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function xe(e){return new Promise((function(t,n){var r=new FileReader;r.onerror=function(){n(new Error("Error reading file"+e.name))},"readAsDataURL"in r?(r.onload=function(e){t(e.target.result)},r.readAsDataURL(e)):(r.onload=function(n){var r=btoa(n.target.result);t("data:"+e.type+";base64,"+r)},r.readAsBinaryString(e))}))}function Pe(e,t,n){var r=function(e,t,n){var r,o=Array.from(e);if(""===t)return r=o.filter((function(e){return"file"===e.kind})),n?r:[r[0]];var i=t.toLowerCase().split(",").map((function(e){return e.split("/").map((function(e){return e.trim()}))})).filter((function(e){return 2===e.length})),a=function(e){if("file"!==e.kind)return!1;for(var t,n=e.type.toLowerCase().split("/").map((function(e){return e.trim()})),r=n[0],o=n[1],a=Object(we.a)(i);!(t=a()).done;){var c=t.value,u=c[0],s=c[1];if(r===u&&("*"===s||o===s))return!0}return!1};r=r=o.filter(a),!1===n&&(r=[r[0]]);return r}(e.items,t,n),o=[];return r.forEach((function(e){var t=e&&e.getAsFile();null!=t&&o.push(t)})),o}var Te=function(e){return void 0===e&&(e={}),function(t,n,r){if(!t.selection instanceof ke.NodeSelection||!t.selection.node)return!1;var o=t.selection.node;return o.type===Ee(t.schema)&&(n&&n(t.tr.setNodeMarkup(t.selection.$from.pos,void 0,Object.assign({},o.attrs,e))),!0)}},Be=n(210),Le=n(153),$e=n(148),_e=function(e){var t=void 0===e?{}:e,n=t.historyOpts,r=void 0===n?{}:n,o=t.keybindings,i=void 0===o?qe:o;return function(){var e;return new $e.b("history",[Be.a(r),i&&Object(Le.a)((e={},e[i.undo]=Re(),e[i.redo]=ze(),e))])}},Ve={undo:Re,redo:ze},qe={undo:"Mod-z",redo:"Mod-y Shift-Mod-z"};function Re(){return Be.c}function ze(){return Be.b}var He="editorStateCounter",Ue=function(){return function(){return new $e.b(He,[new $e.a({key:We,state:{init:function(e,t){return 0},apply:function(e,t,n,r){return e.docChanged?t+1:t}}}),new $e.a({key:Fe,state:{init:function(e,t){return 0},apply:function(e,t,n,r){return r.selection.eq(n&&n.selection)?t:t+1}}})])}},We=new $e.c(He),Fe=new $e.c(He)},156:function(e,t,n){"use strict";n.d(t,"g",(function(){return o.b})),n.d(t,"h",(function(){return o.c})),n.d(t,"j",(function(){return o.i})),n.d(t,"m",(function(){return o.o})),n.d(t,"n",(function(){return o.p})),n.d(t,"k",(function(){return o.l})),n.d(t,"i",(function(){return o.g})),n.d(t,"a",(function(){return h})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return m.a})),n.d(t,"f",(function(){return u.a})),n.d(t,"d",(function(){return b.a})),n.d(t,"e",(function(){return b.c})),n.d(t,"l",(function(){return r.b}));n(158);var r=n(150),o=(n(165),n(154)),i=n(185),a=n(142),c=n(144),u=n(161),s=n(166),d=function(e){var t=void 0===e?{}:e,n=t.specRegistry,r=t.specs,o=t.plugins,i=void 0===o?[]:o,c=t.initialValue,d=t.editorProps,f=t.pmStateOpts;if(r&&n)throw new Error("Cannot have both specs and specRegistry defined");n||(n=new u.a(r)),this.specRegistry=n;var p=this.specRegistry.schema;this.pmState=a.EditorState.create(Object.assign({schema:p,doc:l({schema:p,content:c}),plugins:Object(s.a)(n,i,{editorProps:d})},f))},l=function(e){var t=e.schema,n=e.content,r=e.parseOptions;if(null==n)return t.nodeFromJSON({type:"doc",content:[{type:"paragraph"}]});if(n instanceof c.Node)return n;if("object"==typeof n)return t.nodeFromJSON(n);if("string"==typeof n){var o=document.createElement("div");return o.innerHTML=n.trim(),c.DOMParser.fromSchema(t).parse(o,r)}return!1},f=n(159),p=n(141),h=function(){function e(e,t){var n=t.focusOnInit,r=void 0===n||n,o=t.state,a=t.pmViewOpts,c=void 0===a?{}:a;if(this.destroyed=!1,!(o instanceof d))throw new Error("state is required and must be an instance of BangleEditorState");this.view=new i.c(e,Object.assign({state:o.pmState,dispatchTransaction:function(e){var t=this.state.apply(e);this.updateState(t)},attributes:{class:"bangle-editor"}},c)),r&&this.focusView()}var t=e.prototype;return t.focusView=function(){f.b||this.view.focused||this.view.focus()},t.destroy=function(){this.destroyed||(null!==this.view.docView?(this.destroyed=!0,this.view.destroy()):this.destroyed=!0)},t.toHTMLString=function(){return Object(p.r)(this.view.state)},e}(),m=n(160),b=n(148)},158:function(e,t,n){"use strict"},159:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i}));var r=void 0;try{r="production"}catch(a){}var o="production"===r,i="test"===r},160:function(e,t,n){"use strict";n.d(t,"a",(function(){return s})),n.d(t,"b",(function(){return d}));var r=n(4),o=n(190),i=n(148),a=n(146),c=function(){},u=new WeakMap,s=function(e){function t(){return e.apply(this,arguments)||this}Object(r.a)(t,e),t.createPlugin=function(e){var n,r=e.name,o=e.containerDOM,c=e.contentDOM,u=e.renderHandlers;return new i.a({key:new i.c(r+"NodeView"),props:{nodeViews:(n={},n[r]=function(e,n,r,i){var s,d=Object(a.d)(o);return c&&(s=Object(a.d)(c)),new t({node:e,view:n,getPos:r,decorations:i,containerDOM:d,contentDOM:s,renderHandlers:u})},n)}})};var n=t.prototype;return n.update=function(e,t){return c("update node"),this._node.type===e.type&&(this._node===e&&this._decorations===t?(c("update node no change"),!0):(this._node=e,this._decorations=t,c("update node execute"),this.renderHandlers.update(this,this.getNodeViewProps()),!0))},n.selectNode=function(){this.containerDOM.classList.add("ProseMirror-selectednode"),this._selected=!0,c("select node"),this.renderHandlers.update(this,this.getNodeViewProps())},n.deselectNode=function(){this.containerDOM.classList.remove("ProseMirror-selectednode"),this._selected=!1,c("deselectNode node"),this.renderHandlers.update(this,this.getNodeViewProps())},n.ignoreMutation=function(e){return!!this._node.type.isAtom||"selection"!==e.type&&(!this.containerDOM.contains(e.target)&&e.target!==this.contentDOM)},n.destroy=function(){this.renderHandlers.destroy(this,this.getNodeViewProps()),this.containerDOM=void 0,this.contentDOM=void 0},t}(function(){var e=t.prototype;function t(e,t){var n=e.node,r=e.view,o=e.getPos,i=e.decorations,c=e.containerDOM,s=e.contentDOM,d=e.renderHandlers,l=void 0===d?function(e){var t=e.dom.parentNode;return u.get(t)}(r):d,f=(void 0===t?{}:t).selectionSensitive,p=void 0===f||f;if(this._node=n,this._view=r,this._getPos=o,this._decorations=i,this._selected=!1,!l)throw Object(a.b)("It appears the view =",r," was not associated with renderHandlers. You are either using nodeViews accidentally or have incorrectly setup nodeViews"),new Error("You either did not pass the renderHandlers correct or it cannot find render handlers associated with the view.");if(this.renderHandlers=l,this.containerDOM=c,this.contentDOM=s,this.contentDOM&&this.contentDOM.classList.add("bangle-nv-content"),this.containerDOM&&this.containerDOM.classList.add("bangle-nv-container"),this._node.type.isAtom&&this.contentDOM)throw new Error("An atom node cannot have a contentDOM");this.opts={selectionSensitive:p},this.renderHandlers.create(this,this.getNodeViewProps())}return e.getAttrs=function(){return this._node.attrs},e.getNodeViewProps=function(){var e=this;return{node:this._node,view:this._view,getPos:this._getPos,decorations:this._decorations,selected:this._selected,attrs:this._node.attrs,updateAttrs:function(t){var n,r,o;e._view.dispatch((n=e._getPos(),r=e._node,o=t,e._view.state.tr.setNodeMarkup(n,void 0,Object.assign({},r.attrs,o))))}}},Object(o.a)(t,[{key:"dom",get:function(){return this.containerDOM}}]),t}());function d(e,t){if(u.has(e))throw new Error("It looks like renderHandlers were already set by someone else.");u.set(e,t)}},161:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(164),o=n(190),i=n(144),a=n(154),c=n(146),u=function(){function e(e,t){void 0===e&&(e=[]);var n=(void 0===t?{}:t).defaultSpecs,o=void 0===n||n,u=d(e);u.forEach(s);var l=new Set(u.map((function(e){return e.name})));if(u.length!==l.size)throw Object(c.b)("The specRegistry has one or more specs with the same name",u),new Error("Duplicate spec error, please check your specRegistry");if(o){var f=[];l.has("paragraph")||f.unshift(a.q.spec()),l.has("text")||f.unshift(a.s.spec()),l.has("doc")||f.unshift(a.f.spec()),u=[].concat(d(f),u)}this._spec=u,this._schema=function(e){for(var t,n,o=[],a=[],c=Object(r.a)(e);!(n=c()).done;){var u=n.value;if("node"===u.type)o.push([u.name,u.schema]);else if("mark"===u.type)a.push([u.name,u.schema]);else if("component"!==u.type)throw new Error(u.name+" unknown type: "+u.type);!0===u.topNode&&(t=u.name)}return new i.Schema({topNode:t,nodes:Object.fromEntries(o),marks:Object.fromEntries(a)})}(this._spec),this._options=Object.fromEntries(this._spec.filter((function(e){return e.options})).map((function(e){return[e.name,e.options]})))}return Object(o.a)(e,[{key:"spec",get:function(){return this._spec}},{key:"schema",get:function(){return this._schema}},{key:"options",get:function(){return this._options}}]),e}();function s(e){if(!e.name)throw Object(c.b)("The spec didn't have a name field",e),new Error("Invalid spec. Spec must have a name");if(!["node","mark","component"].includes(e.type))throw Object(c.b)("The spec must be of type node, mark or component ",e),new Error("Invalid spec type");if(["node","mark"].includes(e.type)&&!e.schema)throw Object(c.b)("The spec of type 'mark' or 'node' must have a schema field",e),new Error("Invalid spec schema")}function d(e){return function e(t){return Array.isArray(t)?t.flatMap((function(t){return e(t)})).filter(Boolean):t}(e)}},162:function(e,t,n){"use strict";n.d(t,"b",(function(){return o})),n.d(t,"a",(function(){return i}));var r=n(154);function o(){return[].concat([r.b.spec(),r.d.spec(),r.m.spec(),r.r.spec(),r.n.spec(),r.t.spec()],[r.f.spec(),r.s.spec(),r.q.spec(),r.a.spec(),r.c.spec(),r.e.spec(),r.h.spec(),r.i.spec(),r.k.spec(),r.o.spec(),r.p.spec(),r.l.spec()])}function i(){return[r.b.plugins(),r.d.plugins(),r.m.plugins(),r.r.plugins(),r.n.plugins(),r.t.plugins(),r.q.plugins(),r.a.plugins(),r.c.plugins(),r.e.plugins(),r.h.plugins(),r.i.plugins(),r.k.plugins(),r.o.plugins(),r.p.plugins(),r.l.plugins(),r.j.plugins()]}},163:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(4),o=n(209),i=0,a=new(function(e){function t(){return e.apply(this,arguments)||this}return Object(r.a)(t,e),t.prototype.get=function(t){var n=e.prototype.get.call(this,t);return n||(n=(i++).toString(),this.set(t,n),n)},t}(Object(o.a)(WeakMap)))},165:function(e,t,n){"use strict";n(150),n(162);var r=n(179);n.d(t,"b",(function(){return r.a}));n(159);var o=n(146);n.d(t,"a",(function(){return o.d}));n(153),n(158),n(151),n(152),n(163),n(180),n(166),n(141)},166:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(164),o=n(147),i=n(145),a=n(207),c=n(143),u=n(208),s=n(146),d=n(148),l=n(154);function f(e,t,n){var f=void 0===n?{}:n,h=f.editorProps,m=f.defaultPlugins,b=void 0===m||m,v=f.dropCursorOpts,g=f.transformPlugins,O=void 0===g?function(e){return e}:g,y=e.schema,w=p(t,{schema:y,specRegistry:e}),j=w[0],k=w[1];if(b){var M=[];k.has("history")||M.push(l.j.plugins()),k.has("editorStateCounter")||M.push(l.g.plugins()),(j=function(e,t){var n=void 0===t?{}:t,r=n.inputRules,a=void 0===r||r,c=n.undoInputRule,u=void 0===c||c,s=[],d=[];e.forEach((function(e){e instanceof o.a?d.push(e):s.push(e)})),a&&(e=[].concat(s,[Object(o.b)({rules:d})]));u&&e.push(Object(i.b)({Backspace:o.d}));return e}(j=j.concat(p(M,{schema:y,specRegistry:e})[0]))).push(Object(i.b)(c.b),Object(u.a)(v),Object(a.a)())}if(h&&j.push(new d.a({props:h})),(j=O(j=j.filter(Boolean))).some((function(e){return!(e instanceof d.a)})))throw Object(s.b)("You are either using multiple versions of the library or not returning a Plugin class in your plugins. Investigate :",j.find((function(e){return!(e instanceof d.a)}))),new Error("Invalid plugin");return function(e,t){for(var n,o=e.filter((function(e){return e.props&&e.props.nodeViews})),i=new Map,a=Object(r.a)(o);!(n=a()).done;)for(var c=n.value,u=0,d=Object.keys(c.props.nodeViews);u<d.length;u++){var l=d[u];if(!t.schema.nodes[l])throw Object(s.b)("When loading your plugins, we found nodeView implementation for the node '"+l+"' did not have a corresponding spec. Check the plugin:",c,"and your specRegistry",t),new Error("NodeView validation failed. Spec for '"+l+"' not found.");if(i.has(l))throw Object(s.b)("When loading your plugins, we found more than one nodeView implementation for the node '"+l+"'. Bangle can only have a single nodeView implementation, please check the following two plugins",c,i.get(l)),new Error("NodeView validation failed. Duplicate nodeViews for '"+l+"' found.");i.set(l,c)}}(j,e),j}function p(e,t){var n=new Set;return[function e(r){if(Array.isArray(r))return r.flatMap((function(t){return e(t)})).filter(Boolean);if(r instanceof d.b){if(n.has(r.name))throw new Error("Duplicate names of pluginGroups "+r.name+" not allowed.");return n.add(r.name),e(r.plugins)}if("function"==typeof r){if(!t)throw new Error("Found a function but no payload");return e(r(t))}return r}(e),n]}},167:function(e,t,n){"use strict";n.d(t,"d",(function(){return p})),n.d(t,"g",(function(){return g})),n.d(t,"c",(function(){return y})),n.d(t,"f",(function(){return w})),n.d(t,"a",(function(){return j})),n.d(t,"b",(function(){return k})),n.d(t,"e",(function(){return S})),n.d(t,"h",(function(){return A}));var r=n(169),o=n(206),i=n(143),a=n(144),c=n(157),u=n(142),s=n(146),d=n(141),l=n(181);function f(e,t,n,o){var i=n.$from,c=n.$to,u=e;u||(u=t.schema.nodes.listItem);var s=i.blockRange(c,(function(e){return!!e.childCount&&!!e.firstChild&&e.firstChild.type===u}));if(!s||s.depth<2||i.node(s.depth-1).type!==u)return o;var d=s.end,l=c.end(s.depth);return d<l&&(o.step(new r.b(d-1,l,d,l,new a.Slice(a.Fragment.from(u.create(void 0,s.parent.copy())),1,0),1,!0)),s=new a.NodeRange(o.doc.resolve(i.pos),o.doc.resolve(l),s.depth)),o.lift(s,Object(r.j)(s)).scrollIntoView()}var p=function(e,t){return e.type===t.nodes.listItem&&"boolean"==typeof e.attrs.todoChecked},h=function(e,t){for(var n=t.bulletList,r=t.orderedList,o=0,i=e.depth-1;i>0;i--){var a=e.node(i);a.type!==n&&a.type!==r||(o+=1)}return o},m=function(e){return function(t){var n=t.selection.$from.parent,r=e;r||(r=t.schema.nodes.listItem);var o=t.schema.nodes.paragraph;return t.selection instanceof l.a?n.type===r:n.type===o&&Object(c.hasParentNodeOfType)(r)(t.selection)}};var b=function(e){return function(t){var n=t.selection.$from,r=e;r||(r=t.schema.nodes.listItem);var o=t.schema.nodes.paragraph;return t.selection instanceof l.a?n.parent.type===r:Object(c.hasParentNodeOfType)(r)(t.selection)&&n.parent.type===o}};function v(e){var t=e.selection.$from,n=e.schema.nodes,r=n.bulletList,o=n.orderedList,i=e.doc.resolve(t.pos-1),a=i?i.nodeBefore:null;return e.selection instanceof l.a&&(a=t.nodeBefore),!!a&&[r,o].indexOf(a.type)>-1}function g(e,t,n){return function(r,a,c){var s=r.selection,l=s.$from.node(s.$from.depth-2),p=s.$to.node(s.$to.depth-2);if(l&&l.type.name===e.name&&p&&p.type.name===e.name){var h=t||r.schema.nodes.listItem,m=function(e,t,n){for(var r,o=e,i=n.bulletList,a=n.orderedList,c=t.depth-1;c>0;c--){var u=t.node(c);if(u.type!==i&&u.type!==a||(r=c),u.type!==i&&u.type!==a&&u.type!==o)break}return r}(h,s.$to,r.schema.nodes),b=s.$to.pos;s instanceof u.NodeSelection&&s.node.type===h&&(b=s.$from.pos+s.node.firstChild.content.size);var v=r.tr,g=function(e,t,n,r,o,i){var a=e;a||(a=t.schema.nodes.listItem);var c=!1;return i.doc.nodesBetween(n,r,(function(e,r){if(!c&&e.type===a&&r>n){c=!0;for(var s=o+3;s>o+2;){var d=i.doc.resolve(i.mapping.map(r));s=d.depth;var l=i.doc.resolve(i.mapping.map(r+e.content.size)),p=new u.TextSelection(d,l);i=f(a,t,p,i)}}})),i}(h,r,b,s.$to.end(m),m||0,v);return g=function(e,t,n){var r=t.selection,o=r.from,i=r.to,a=t.schema.nodes.paragraph,c=[];n.doc.nodesBetween(o,i,(function(e,t){e.type===a&&c.push({node:e,pos:t})}));for(var u=c.length-1;u>=0;u--){var s=c[u],l=n.doc.resolve(n.mapping.map(s.pos));if(l.depth>0){var f=void 0;f=s.node.textContent&&s.node.textContent.length>0?n.doc.resolve(n.mapping.map(s.pos+s.node.textContent.length)):n.doc.resolve(n.mapping.map(s.pos+1));var p=l.blockRange(f);p&&n.lift(p,Object(d.e)(e,t.schema,l))}}return n}(h,r,g),a&&a(g),!0}return function(e,t){void 0===t&&(t=!1);return function(n,r,a){if(r&&r(n.tr.setSelection(function(e,t){var n=t.$from,r=t.$to,o=n.pos===r.pos,i=n.pos,a=r.pos;if(o&&i===e.nodeSize-3)return t;if(n.nodeBefore&&!o){i++;for(var c=e.nodeAt(i);!c||c&&!c.isText;)i++,c=e.nodeAt(i)}if(a===i)return new u.TextSelection(e.resolve(i));return new u.TextSelection(e.resolve(i),e.resolve(a))}(n.doc,n.selection))),!a)return!1;var c=(n=a.state).selection,s=c.$from,l=c.$to,f=Object(d.m)(n.doc,s,l,e);if(function(e,t){var n=e.selection.$from,r=n.node(-2),o=n.node(-3);return r&&r.type===t||o&&o.type===t}(n,e)&&f)return O()(n,r);f||(O()(n,r),n=a.state);var p,h,m=Object(d.q)(n,e);return m&&r&&(r(m),n=a.state),r&&t&&(r=function(e,t){return function(n){for(var r=[],o=0;o<n.mapping.maps.length;o++){for(var i=n.mapping.maps[o],a=0;a<r.length;a++)r[a]=i.map(r[a]);i.forEach((function(e,t,n,o){r.push(n,o)}))}for(var c=function(e,n){return e.type===t.nodes.listItem&&n.type===t.nodes.bulletList},u=function(e){var t=r[e],o=r[e+1];n.doc.nodesBetween(t,o,(function(e,r,i){r>=t&&r<o&&c(e,i)&&n.setNodeMarkup(r,void 0,Object.assign({},e.attrs,{todoChecked:!1}))}))},s=0;s<r.length;s+=2)u(s);e(n)}}(r,n.schema)),(p=e,i.a(o.c(p,h),(function(e,t){return e.type===t.type&&e.type===p})))(n,r)}}(e,n)(r,a,c)}}function O(){return function(e,t){var n=e.tr,o=e.selection,i=o.$from,a=o.$to;return n.doc.nodesBetween(i.pos,a.pos,(function(t,o){if(t.isTextblock){var i=new u.NodeSelection(n.doc.resolve(n.mapping.map(o))),a=i.$from.blockRange(i.$to);if(!a||![e.schema.nodes.listItem].includes(i.$from.parent.type))return!1;var c=a&&Object(r.j)(a);if(null==c)return!1;n.lift(a,c)}})),t&&t(n),!0}}function y(e){return function(t,n){var r=e;return r||(r=t.schema.nodes.listItem),!!b(r)(t)&&(function(e,t){var n,r=t.tr.selection.$to.pos;do{var o=t.doc.resolve(r);if((n=h(o,t.schema.nodes))>4)return!1;r++}while(n>=e);return!0}(h(t.selection.$from,t.schema.nodes),t)&&o.b(r)(t,n),!0)}}function w(e){return function(t,n){var r=e;r||(r=t.schema.nodes.listItem);var i=t.selection,a=i.$from,c=i.$to;if(b(r)(t)){var u=a.blockRange(c,(function(e){return e.childCount>0&&e.firstChild.type===r}));return!!u&&Object(s.c)(function(e,t){return function(n){return function(r,o){return n(r,(function(n){var i=r.doc.resolve(t.start),a=r.doc.resolve(t.end),c=n.doc.resolve(n.mapping.map(t.end-1));c.nodeBefore&&c.nodeAfter&&c.nodeBefore.type===c.nodeAfter.type&&a.nodeAfter&&a.nodeAfter.type===e&&a.parent.type===i.parent.type&&n.join(c.pos),o&&o(n.scrollIntoView())}))}}}(r,u),o.a)(r)(t,n)}return!1}}var j=function(e){return function(){return i.c(Object(d.a)([b(e),d.i,d.j,function(e){return m(e.schema.nodes.listItem)(e)},function(e){var t=e.selection.$from.node(-3);return p(t,e.schema)}],(function(e,t,n){var r=e.selection.$from.node(-1);return t&&t(e.tr.setNodeMarkup(e.selection.$from.before(-1),void 0,Object.assign({},r.attrs,{todoChecked:!1}))),w((e=n.state).schema.nodes.listItem)(e,t,n)})),Object(d.a)([b(e),d.i,d.j,m(e)],i.c(C(e),w(e))),Object(d.a)([d.i,v],M(e))).apply(void 0,arguments)}};function k(e){return function(t,n,r){var o,i=t.selection;if(i.empty){var u=i.$from,s=e;s||(s=t.schema.nodes.listItem);var l=t.schema.nodes.codeBlock,f=u.node(u.depth),h=u.node(u.depth-1);if(h&&h.type===s){var m=Object(d.g)(h);if(Object(d.l)(f)&&!m){var b=u.node(u.depth-3);return p(b,t.schema)&&!p(h,t.schema)?(n&&n(t.tr.setNodeMarkup(t.selection.$from.before(-1),void 0,Object.assign({},h.attrs,{todoChecked:!1}))),w(t.schema.nodes.listItem)(r.state,n,r)):w(s)(t,n)}if(!Object(c.hasParentNodeOfType)(l)(i))return(o=s,function(e,t){var n=e.selection,r=n.$from,i=n.$to,c=n.node;if(c&&c.isBlock||r.depth<2||!r.sameParent(i))return!1;var u=r.node(-1);if(u.type!==o)return!1;if(u.content.content.length<=1&&0===r.parent.content.size&&0!==u.content.size){if(2===r.depth||r.node(-3).type!==o||r.index(-2)!==r.node(-2).childCount-1)return!1;if(t){for(var s=a.Fragment.empty,d=r.index(-1)>0,l=r.depth-(d?1:2);l>=r.depth-3;l--)s=a.Fragment.from(r.node(l).copy(s));s=s.append(a.Fragment.from(o.createAndFill()));var f=e.tr.replace(r.before(d?void 0:-1),r.after(-3),new a.Slice(s,d?3:2,2));f.setSelection(e.selection.constructor.near(f.doc.resolve(r.pos+(d?3:2)))),t(f.scrollIntoView())}return!0}var p=i.pos===r.end()?u.contentMatchAt(0).defaultType:void 0,h=e.tr.delete(r.pos,i.pos),m=p&&[void 0,{type:p}];return t&&t(h.split(r.pos,2,m).scrollIntoView()),!0})(t,n)}}return!1}}function M(e){return function(t,n){var o=e;o||(o=t.schema.nodes.listItem);var i=t.selection.$from,u=t.schema.nodes,s=u.paragraph,f=u.codeBlock,p=u.bulletList,h=u.orderedList,m=t.selection instanceof l.a,b=m?t.doc.resolve(i.pos+1):i,v=Object(d.b)(b);if(!v)return!1;if(v.nodeBefore&&[p,h].indexOf(v.nodeBefore.type)>-1&&v.nodeAfter&&(v.nodeAfter.type===s||v.nodeAfter.type===f)){for(var g=v.doc.resolve(v.pos-1);g.parent.type!==s;)g=t.doc.resolve(g.pos-1);var O=t.tr;if(m){var y=Object(c.findPositionOfNodeBefore)(O.selection);if("number"!=typeof y)return!1;var w=v.nodeBefore.copy(v.nodeBefore.content.append(a.Fragment.from(o.createChecked({},v.nodeAfter))));O.replaceWith(y,i.pos+v.nodeAfter.nodeSize,w)}else O=t.tr.step(new r.b(g.pos,v.pos+v.nodeAfter.nodeSize,v.pos+1,v.pos+v.nodeAfter.nodeSize-1,t.tr.doc.slice(g.pos,v.pos),0,!0));var j=O.doc.resolve(O.mapping.map(v.pos+v.nodeAfter.nodeSize));return j.nodeBefore&&j.nodeAfter&&j.nodeBefore.type===j.nodeAfter.type&&[p,h].indexOf(j.nodeBefore.type)>-1&&(O=O.join(j.pos)),n&&n(O.scrollIntoView()),!0}return!1}}function C(e){return function(t,n){var r=t.selection.$from,o=e;o||(o=t.schema.nodes.listItem);var i=Object(d.b)(r);if(!i||!i.nodeBefore||i.nodeBefore.type!==o)return!1;if(1===i.nodeBefore.childCount&&i.nodeBefore.firstChild.nodeSize<=2){var a=t.tr;return n&&n(a.delete(i.pos-i.nodeBefore.nodeSize,r.pos).scrollIntoView()),!0}return!1}}function S(e,t){void 0===t&&(t="UP");var n="DOWN"===t;return Object(d.a)([function(t){var r=Object(c.findParentNodeOfType)(e)(t.selection);if(!r)return!1;var o=r.node,i=t.selection.$from.node(r.depth-1),a=i&&i[n?"lastChild":"firstChild"];return!(!o||a!==o)}],(function(t,r){var o=e;if(o||(o=t.schema.nodes.listItem),!t.selection.empty)return!1;var i=Object(c.findParentNode)((function(e){return Object(d.s)(e.type,t.schema.nodes)}))(t.selection),a=Object(c.findParentNodeOfType)(o)(t.selection);if(!(i&&i.node&&a&&a.node))return!1;if(3===t.selection.$from.depth)return w(o)(t,r);var u=1===i.node.childCount?i:a,s=t.tr.delete(u.pos,u.pos+u.node.nodeSize),l=t.selection.$from.before(-3);if(n){var f=t.selection.$from.after(-3);l=f-u.node.nodeSize;var p=Object(d.t)(f,t.doc)&&t.doc.nodeAt(f);p&&p.type===o&&(l+=p.nodeSize)}var h=a.node,m=Object(c.safeInsert)(h,l)(s);return m!==s&&(r&&r(m),!0)}))}function A(e,t){return function(n,r){var o=n.selection.$from,i=o.node(-1);if(i&&i.type===e){var a=n.tr,c=o.before(-1);if(t(i.attrs)!==i.attrs)return a.setNodeMarkup(c,void 0,t(i.attrs)),r(a),!0}return!1}}},168:function(e,t,n){"use strict";n.r(t),n.d(t,"spec",(function(){return a})),n.d(t,"plugins",(function(){return c})),n.d(t,"commands",(function(){return u})),n.d(t,"createLink",(function(){return p})),n.d(t,"updateLink",(function(){return h})),n.d(t,"queryLinkAttrs",(function(){return m})),n.d(t,"queryIsLinkAllowedInRange",(function(){return b})),n.d(t,"queryIsLinkActive",(function(){return v})),n.d(t,"queryIsSelectionAroundLink",(function(){return g}));var r=n(142),o=n(146),i=n(141),a=function(e){var t=(void 0===e?{}:e).openOnClick;return{type:"mark",name:s,schema:{attrs:{href:{default:null}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs:function(e){return{href:e.getAttribute("href")}}}],toDOM:function(e){return["a",Object.assign({},e.attrs,{rel:"noopener noreferrer nofollow"}),0]}},markdown:{toMarkdown:{open:function(e,t,n,r){return l(t,n,r,1)?"<":"["},close:function(e,t,n,r){return l(t,n,r,-1)?">":"]("+e.esc(t.attrs.href)+(t.attrs.title?" "+e.quote(t.attrs.title):"")+")"}},parseMarkdown:{link:{mark:"link",getAttrs:function(e){return{href:e.attrGet("href"),title:e.attrGet("title")||null}}}}},options:{openOnClick:void 0!==t&&t}}},c=function(){return function(e){var t,n=e.schema,a=e.specRegistry.options.link.openOnClick,c=function(e){return e.marks.link}(n);return[(t=/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{2,256}\.[a-zA-Z]{2,}\b([-a-zA-Z0-9@:%_+.~#?&//=]*)/g,new r.Plugin({props:{handlePaste:function(e,n,r){var i=n;if(!i.clipboardData)return!1;var a=i.clipboardData.getData("text/plain"),c=i.clipboardData.getData("text/html"),u=a&&!c;if(!u||e.state.selection.empty)return!1;var s=e.state,d=e.dispatch,l=Object(o.e)(t,a),f=1===l.length&&l.every((function(e){return e.match}));return!!f&&p(a)(s,d)}}})),d(/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{2,256}\.[a-zA-Z]{2,}\b([-a-zA-Z0-9@:%_+.~#?&//=]*)/g,c,(function(e){return{href:e}})),a&&new r.Plugin({props:{handleClick:function(e,t,n){var r=e.state.schema,o=Object(i.f)(e.state,r.marks.link);o.href&&n.target instanceof HTMLAnchorElement&&(n.stopPropagation(),window.open(o.href))}}})]}},u={createLink:p,updateLink:h,queryLinkAttrs:m,queryIsLinkAllowedInRange:b,queryIsLinkActive:v,queryIsSelectionAroundLink:g},s="link";function d(e,t,n){return new r.Plugin({props:{transformPasted:function(r){return Object(i.o)(r,(function(r){if(!r.isText)return r;var i=r.text;return Object(o.e)(e,i).map((function(e){var o=e.start,i=e.end,a=e.match,c=e.subString,u=r.cut(o,i);if(a){var s=n instanceof Function?n(c):n;u=u.mark(t.create(s).addToSet(r.marks))}return u}))}))}}})}function l(e,t,n,r){if(e.attrs.title||!/^\w+:/.test(e.attrs.href))return!1;var o=t.child(n+(r<0?-1:0));if(!o.isText||o.text!==e.attrs.href||o.marks[o.marks.length-1]!==e)return!1;if(n===(r<0?1:t.childCount-1))return!0;var i=t.child(n+(r<0?-2:1));return!e.isInSet(i.marks)}function f(e,t,n){return n=n&&n.trim(),Object(i.a)((function(t){return(n=e,function(e){var t=e.doc.nodeAt(n);return!!t&&t.isText})(t);var n}),(function(r,o){var i=r.schema.marks.link,a=r.tr.removeMark(e,t,i);if(n){var c=r.schema.marks.link.create({href:n});a.addMark(e,t,c)}return o&&o(a),!0}))}function p(e){return Object(i.a)((function(e){return b(e.selection.$from.pos,e.selection.$to.pos)(e)}),(function(t,n){var r=[t.selection.$from.pos,t.selection.$to.pos],o=r[0],i=r[1],a=t.schema.marks.link,c=t.tr.removeMark(o,i,a);if(e.trim()){var u=t.schema.marks.link.create({href:e});c.addMark(o,i,u)}return n&&n(c),!0}))}function h(e){return function(t,n){if(!t.selection.empty)return f(t.selection.$from.pos,t.selection.$to.pos,e)(t,n);var r=t.selection.$from,o=r.pos-r.textOffset,i=t.doc.nodeAt(o),a=o;return i&&(a+=i.nodeSize),f(o,a,e)(t,n)}}function m(){return function(e){var t=e.selection.$from,n=t.pos-t.textOffset,r=e.doc.resolve(n),o=e.doc.nodeAt(n),i=r.nodeAfter;if(i){var a=e.schema.marks.link.isInSet(i.marks||[]);return a?{href:a.attrs.href,text:o.textContent}:void 0}}}function b(e,t){return function(n){var r=n.doc.resolve(e),o=n.doc.resolve(t),i=n.schema.marks.link;if(r.parent===o.parent&&r.parent.isTextblock)return r.parent.type.allowsMarkType(i)}}function v(){return function(e){return!!e.doc.type.schema.marks.link.isInSet(e.selection.$from.marks())}}function g(){return function(e){var t=e.selection,n=t.$from,r=t.$to,o=n.nodeAfter;return!!o&&0===n.textOffset&&r.pos-n.pos===o.nodeSize&&!!e.doc.type.schema.marks.link.isInSet(o.marks)}}},171:function(e,t,n){"use strict";n.r(t),n.d(t,"spec",(function(){return f})),n.d(t,"plugins",(function(){return p})),n.d(t,"commands",(function(){return h})),n.d(t,"defaultKeys",(function(){return m})),n.d(t,"toggleHeading",(function(){return O})),n.d(t,"queryIsHeadingActive",(function(){return y})),n.d(t,"queryIsCollapseActive",(function(){return w})),n.d(t,"collapseHeading",(function(){return j})),n.d(t,"uncollapseHeading",(function(){return k})),n.d(t,"toggleHeadingCollapse",(function(){return M})),n.d(t,"uncollapseAllHeadings",(function(){return C})),n.d(t,"listCollapsedHeading",(function(){return S})),n.d(t,"listCollapsibleHeading",(function(){return A})),n.d(t,"flattenFragmentJSON",(function(){return D}));var r=n(164),o=n(143),i=n(147),a=n(157),c=n(144),u=n(142),s=n(153),d=n(149),l=n(141),f=function(e){var t=(void 0===e?{}:e).levels,n=void 0===t?v:t;if(n.some((function(e){return"number"!=typeof e})))throw new Error("levels must be number");return{type:"node",name:b,schema:{attrs:{level:{default:1},collapseContent:{default:null}},content:"inline*",group:"block",defining:!0,draggable:!1,parseDOM:n.map((function(e){return{tag:"h"+e,getAttrs:function(t){var n={level:g(e)},r=t.getAttribute("data-bangle-attrs");if(!r)return n;var o=JSON.parse(r);return Object.assign({},n,o)}}})),toDOM:function(e){var t=["h"+e.attrs.level,{},0];return e.attrs.collapseContent&&(t[1]["data-bangle-attrs"]=JSON.stringify({collapseContent:e.attrs.collapseContent}),t[1].class="bangle-heading-collapsed"),t}},markdown:{toMarkdown:function(e,t){e.write(e.repeat("#",t.attrs.level)+" "),e.renderInline(t),e.closeBlock(t)},parseMarkdown:{heading:{block:b,getAttrs:function(e){return{level:g(e.tag.slice(1))}}}}},options:{levels:n}}},p=function(e){var t=void 0===e?{}:e,n=t.markdownShortcut,r=void 0===n||n,a=t.keybindings,c=void 0===a?m:a;return function(e){var t,n=e.schema,a=e.specRegistry.options[b].levels,u=function(e){return e.nodes[b]}(n),f=function(e){return Object(l.d)(u)(e.selection)},p=Object.fromEntries(a.map((function(e){return[c["toH"+e],Object(o.e)(u,{level:e})]})));return[c&&Object(s.b)(Object.assign({},p,(t={},t[c.moveUp]=Object(d.c)(u,"UP"),t[c.moveDown]=Object(d.c)(u,"DOWN"),t[c.emptyCopy]=Object(d.a)(u),t[c.emptyCut]=Object(d.b)(u),t[c.insertEmptyParaAbove]=Object(l.a)(f,Object(l.h)(n.nodes.paragraph,"above",!1)),t[c.insertEmptyParaBelow]=Object(l.a)(f,Object(l.h)(n.nodes.paragraph,"below",!1)),t[c.toggleCollapse]=M(),t)))].concat((r?a:[]).map((function(e){return Object(i.c)(new RegExp("^(#{1,"+e+"})\\s$"),u,(function(){return{level:e}}))})))}},h={toggleHeading:O,queryIsHeadingActive:y},m={toH1:"Shift-Ctrl-1",toH2:"Shift-Ctrl-2",toH3:"Shift-Ctrl-3",toH4:"Shift-Ctrl-4",toH5:"Shift-Ctrl-5",toH6:"Shift-Ctrl-6",moveDown:"Alt-ArrowDown",moveUp:"Alt-ArrowUp",emptyCopy:"Mod-c",emptyCut:"Mod-x",insertEmptyParaAbove:"Mod-Shift-Enter",insertEmptyParaBelow:"Mod-Enter",toggleCollapse:null},b="heading",v=[1,2,3,4,5,6],g=function(e){return e=parseInt(e,10),Number.isNaN(e)?void 0:e};function O(e){return void 0===e&&(e=3),function(t,n,r){return y(e)(t)?Object(o.e)(t.schema.nodes.paragraph)(t,n,r):Object(o.e)(t.schema.nodes[b],{level:e})(t,n,r)}}function y(e){return function(t){var n=Object(l.d)(t.schema.nodes[b])(t.selection);if(!n)return!1;var r=n.node;return null==e||r.attrs.level===e}}function w(){return function(e){var t=Object(l.d)(e.schema.nodes[b])(e.selection);return!(!t||!E(t))&&Boolean(t.node.attrs.collapseContent)}}function j(){return function(e,t){var n=Object(l.d)(e.schema.nodes[b])(e.selection);if(!n||!E(n))return!1;if(w()(e,t))return!1;var r=function(e,t){var n=void 0,r=void 0,o=!1,i=function(t){return t.type===e.type&&t.attrs.level<=e.attrs.level};if(t.forEach((function(t,a,c){if(!o)if(t!==e){if(n){if(i(t))return void(o=!0);0!==t.content.size&&(r={index:c,offset:a,node:t})}}else n={index:c,offset:a,node:t}})),!r)return null;return{fragment:t.slice(n.offset+n.node.nodeSize,r.offset+r.node.nodeSize).content,start:n.offset,end:r.offset+r.node.nodeSize}}(n.node,e.doc);if(!r)return!1;var o=r.fragment,i=r.start,a=r.end,c=e.tr.replaceWith(i,a,e.schema.nodes[b].createChecked(Object.assign({},n.node.attrs,{collapseContent:o.toJSON()}),n.node.content));return e.selection instanceof u.TextSelection&&(c=c.setSelection(u.TextSelection.create(c.doc,e.selection.from))),t&&t(c),!0}}function k(){return function(e,t){var n=Object(l.d)(e.schema.nodes[b])(e.selection);if(!n||!E(n))return!1;if(!w()(e,t))return!1;var r=c.Fragment.fromJSON(e.schema,n.node.attrs.collapseContent),o=e.tr.replaceWith(n.pos,n.pos+n.node.nodeSize,c.Fragment.fromArray([e.schema.nodes[b].createChecked(Object.assign({},n.node.attrs,{collapseContent:null}),n.node.content)]).append(r));return e.selection instanceof u.TextSelection&&(o=o.setSelection(u.TextSelection.create(o.doc,e.selection.from))),t&&t(o),!0}}function M(){return function(e,t){var n=Object(l.d)(e.schema.nodes[b])(e.selection);return n&&1===n.depth?w()(e,t)?k()(e,t):j()(e,t):null}}function C(){return function(e,t){for(var n,o=S(e),i=e.tr,a=0,s=Object(r.a)(o);!(n=s()).done;){var d=n.value,l=d.node,f=d.pos,p=c.Fragment.fromJSON(e.schema,D(l.attrs.collapseContent));i=i.replaceWith(a+f,a+f+l.nodeSize,c.Fragment.fromArray([e.schema.nodes[b].createChecked(Object.assign({},l.attrs,{collapseContent:null}),l.content)]).append(p)),a+=p.size}return e.selection instanceof u.TextSelection&&(i=i.setSelection(u.TextSelection.create(i.doc,e.selection.from))),t&&t(i),!0}}function S(e){return Object(a.findChildren)(e.doc,(function(t){return t.type===e.schema.nodes[b]&&Boolean(t.attrs.collapseContent)}),!1)}function A(e){return Object(a.findChildren)(e.doc,(function(t){return t.type===e.schema.nodes[b]}),!1)}var D=function e(t){var n=[];return t.forEach((function(t){if("heading"===t.type&&t.attrs.collapseContent){var r=t.attrs.collapseContent;n.push(Object.assign({},t,{attrs:Object.assign({},t.attrs,{collapseContent:null})})),n.push.apply(n,e(r))}else n.push(t)})),n};function E(e){return 1===e.depth}},172:function(e,t,n){"use strict";n.r(t),n.d(t,"spec",(function(){return u})),n.d(t,"plugins",(function(){return s})),n.d(t,"commands",(function(){return d})),n.d(t,"defaultKeys",(function(){return l})),n.d(t,"toggleBold",(function(){return p})),n.d(t,"queryIsBoldActive",(function(){return h}));var r=n(143),o=n(145),i=n(151),a=n(152),c=n(141),u=function(e){void 0===e&&(e={});return{type:"mark",name:f,schema:{parseDOM:[{tag:"strong"},{tag:"b",getAttrs:function(e){return"normal"!==e.style.fontWeight&&null}},{style:"font-weight",getAttrs:function(e){return/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}}],toDOM:function(){return["strong",0]}},markdown:{toMarkdown:{open:"**",close:"**",mixable:!0,expelEnclosingWhitespace:!0},parseMarkdown:{strong:{mark:f}}}}},s=function(e){var t=void 0===e?{}:e,n=t.markdownShortcut,r=void 0===n||n,c=t.keybindings,u=void 0===c?l:c;return function(e){var t,n=function(e){return e.marks.bold}(e.schema);return[r&&Object(a.a)(/(?:\*\*|__)([^*_]+)(?:\*\*|__)/g,n),r&&Object(i.a)(/(?:\*\*|__)([^*_]+)(?:\*\*|__)$/,n),u&&Object(o.b)((t={},t[u.toggleBold]=p(),t))]}},d={toggleBold:p,queryIsBoldActive:h},l={toggleBold:"Mod-b"},f="bold";function p(){return function(e,t,n){return Object(r.f)(e.schema.marks.bold)(e,t,n)}}function h(){return function(e){return Object(c.k)(e.schema.marks.bold)(e)}}},173:function(e,t,n){"use strict";n.r(t),n.d(t,"spec",(function(){return s})),n.d(t,"plugins",(function(){return d})),n.d(t,"commands",(function(){return l})),n.d(t,"defaultKeys",(function(){return f})),n.d(t,"toggleCode",(function(){return y})),n.d(t,"queryIsCodeActive",(function(){return w}));var r=n(143),o=n(151),i=n(152),a=n(141),c=n(145),u=n(142),s=function(e){void 0===e&&(e={});return{type:"mark",name:p,schema:{excludes:"_",parseDOM:[{tag:p}],toDOM:function(){return[p,0]}},markdown:{toMarkdown:{open:function(e,t,n,r){return g(n.child(r),-1)},close:function(e,t,n,r){return g(n.child(r-1),1)},escape:!1},parseMarkdown:{code_inline:{mark:p,noCloseToken:!0}}}}},d=function(e){var t=void 0===e?{}:e,n=t.markdownShortcut,u=void 0===n||n,s=t.escapeAtEdge,d=void 0===s||s,l=t.keybindings,p=void 0===l?f:l;return function(e){var t,n=function(e){return e.marks.code}(e.schema),s=[function(e){return e.selection.empty&&e.selection.$cursor}];return[u&&Object(i.a)(/(?:`)([^`]+)(?:`)/g,n),u&&Object(o.a)(/(?:`)([^`]+)(?:`)$/,n),p&&Object(c.b)((t={},t[p.toggleCode]=Object(r.f)(n),t)),d&&Object(c.b)({ArrowRight:Object(a.a)(s,b),ArrowLeft:Object(a.a)(s,v)})]}},l={toggleCode:y,queryIsCodeActive:w},f={toggleCode:"Mod-`"},p="code",h=function(e){return e.schema.marks.code};var m=function(e,t){if(t<0||t>e.doc.content.size)return!1;var n=h(e),r=e.doc.nodeAt(t);return!!r&&r.marks.some((function(e){return e.type===n}))};function b(e,t,n){var r=e.schema.marks.code,o=e.selection.$cursor,i=e.tr.storedMarks,a=O(e,r),c=e.doc.rangeHasMark(o.pos,o.pos,r),u=e.doc.rangeHasMark(o.pos,o.pos+1,r),s=!c&&u&&!(i&&i.length>0);if(!a&&s)return t&&t(e.tr.addStoredMark(r.create())),!0;var d=!(c||u||i&&0===i.length);return!(!a||!d)&&(t&&t(e.tr.removeStoredMark(r)),!0)}function v(e,t,n){var r=h(e),o=O(e,r),i=e.selection.$cursor,a=e.tr.storedMarks,c=m(e,i.pos),s=m(e,i.pos-1),d=m(e,i.pos-2),l=c&&!s&&Array.isArray(a),f=s&&!d&&(null===a||Array.isArray(a)&&!!a.length),p=(l&&Array.isArray(a)&&!a.length||!l&&null===a)&&!s&&d,b=!c&&s&&Array.isArray(a)&&!a.length;if(!o&&p){var v=e.tr.setSelection(u.Selection.near(e.doc.resolve(i.pos-1)));return t&&t(v.removeStoredMark(r)),!0}if(!o&&b)return t&&t(e.tr.addStoredMark(r.create())),!0;if(o&&f){var g=e.tr.setSelection(u.Selection.near(e.doc.resolve(i.pos-1)));return t&&t(g.addStoredMark(r.create())),!0}var y=0===i.index(i.depth-1);return o&&(l||!i.nodeBefore&&y)?(t&&t(e.tr.removeStoredMark(r)),!0):void 0}function g(e,t){var n,r=/`+/g,o=0;if(e.isText)for(;n=r.exec(e.text);)o=Math.max(o,n[0].length);for(var i=o>0&&t>0?" `":"`",a=0;a<o;a++)i+="`";return o>0&&t<0&&(i+=" "),i}function O(e,t){var n=e.selection,r=n.from,o=n.to;if(n.empty)return!!t.isInSet(e.tr.storedMarks||e.selection.$from.marks());var i=!1;return e.doc.nodesBetween(r,o,(function(e){i=i||t.isInSet(e.marks)})),i}function y(){return function(e,t,n){return Object(r.f)(e.schema.marks.code)(e,t,n)}}function w(){return function(e){return Object(a.k)(e.schema.marks.code)(e)}}},174:function(e,t,n){"use strict";n.r(t),n.d(t,"spec",(function(){return u})),n.d(t,"plugins",(function(){return s})),n.d(t,"commands",(function(){return d})),n.d(t,"defaultKeys",(function(){return l})),n.d(t,"toggleItalic",(function(){return p})),n.d(t,"queryIsItalicActive",(function(){return h}));var r=n(151),o=n(152),i=n(143),a=n(141),c=n(145),u=function(e){void 0===e&&(e={});return{type:"mark",name:f,schema:{parseDOM:[{tag:"i"},{tag:"em"},{style:"font-style=italic"}],toDOM:function(){return["em",0]}},markdown:{toMarkdown:{open:"_",close:"_",mixable:!0,expelEnclosingWhitespace:!0},parseMarkdown:{em:{mark:f}}}}},s=function(e){var t=(void 0===e?{}:e).keybindings,n=void 0===t?l:t;return function(e){var t,a=function(e){return e.marks[f]}(e.schema);return[Object(o.a)(/_([^_]+)_/g,a),Object(o.a)(/\*([^*]+)\*/g,a),Object(r.a)(/(?:^|[^_])(_([^_]+)_)$/,a),Object(r.a)(/(?:^|[^*])(\*([^*]+)\*)$/,a),n&&Object(c.b)((t={},t[n.toggleItalic]=Object(i.f)(a),t))]}},d={toggleItalic:p,queryIsItalicActive:h},l={toggleItalic:"Mod-i"},f="italic";function p(){return function(e,t,n){return Object(i.f)(e.schema.marks[f])(e,t,n)}}function h(){return function(e){return Object(a.k)(e.schema.marks[f])(e)}}},175:function(e,t,n){"use strict";n.r(t),n.d(t,"spec",(function(){return s})),n.d(t,"plugins",(function(){return d})),n.d(t,"commands",(function(){return l})),n.d(t,"defaultKeys",(function(){return f})),n.d(t,"convertToParagraph",(function(){return m})),n.d(t,"jumpToStartOfParagraph",(function(){return b})),n.d(t,"jumpToEndOfParagraph",(function(){return v})),n.d(t,"queryIsTopLevelParagraph",(function(){return g})),n.d(t,"queryIsParagraph",(function(){return O}));var r=n(143),o=n(142),i=n(141),a=n(153),c=n(149),u=n(150),s=function(e){void 0===e&&(e={});return{type:"node",name:p,schema:{content:"inline*",group:"block",draggable:!1,parseDOM:[{tag:"p"}],toDOM:function(){return["p",0]}},markdown:{toMarkdown:function(e,t){e.renderInline(t),e.closeBlock(t)},parseMarkdown:{paragraph:{block:"paragraph"}}}}},d=function(e){var t=(void 0===e?{}:e).keybindings,n=void 0===t?f:t;return function(e){var t,r=e.schema,o=h(r),u=Object(c.d)(o,r.nodes.doc);return[n&&Object(a.b)((t={},t[n.convertToParagraph]=m(),t[n.moveUp]=Object(i.a)(u,Object(c.c)(o,"UP")),t[n.moveDown]=Object(i.a)(u,Object(c.c)(o,"DOWN")),t[n.jumpToStartOfParagraph]=b(),t[n.jumpToEndOfParagraph]=v(),t[n.emptyCopy]=Object(i.a)(u,Object(c.a)(o)),t[n.emptyCut]=Object(i.a)(u,Object(c.b)(o)),t[n.insertEmptyParaAbove]=Object(i.a)(u,Object(i.h)(o,"above")),t[n.insertEmptyParaBelow]=Object(i.a)(u,Object(i.h)(o,"below")),t))]}},l={convertToParagraph:m,jumpToStartOfParagraph:b,jumpToEndOfParagraph:v,queryIsParagraph:O,queryIsTopLevelParagraph:g},f={jumpToEndOfParagraph:u.a.mac?"Ctrl-e":"Ctrl-End",jumpToStartOfParagraph:u.a.mac?"Ctrl-a":"Ctrl-Home",moveDown:"Alt-ArrowDown",moveUp:"Alt-ArrowUp",emptyCopy:"Mod-c",emptyCut:"Mod-x",insertEmptyParaAbove:"Mod-Shift-Enter",insertEmptyParaBelow:"Mod-Enter",convertToParagraph:"Ctrl-Shift-0"},p="paragraph",h=function(e){return e.nodes[p]};function m(){return function(e,t){return Object(r.e)(h(e.schema))(e,t)}}function b(){return function(e,t){var n=h(e.schema),r=Object(i.d)(n)(e.selection);if(!r)return!1;var a=r.start;return t(e.tr.setSelection(o.TextSelection.create(e.doc,a))),!0}}function v(){return function(e,t){var n=h(e.schema),r=Object(i.d)(n)(e.selection);if(!r)return!1;var a=r.node,c=r.start;return t(e.tr.setSelection(o.TextSelection.create(e.doc,c+a.content.size))),!0}}function g(){return function(e){var t=h(e.schema);return Object(c.d)(t,e.schema.nodes.doc)(e)}}function O(){return function(e){var t=h(e.schema);return Boolean(Object(i.d)(t)(e.selection))}}},176:function(e,t,n){"use strict";n.r(t),n.d(t,"spec",(function(){return u})),n.d(t,"plugins",(function(){return s})),n.d(t,"commands",(function(){return d})),n.d(t,"defaultKeys",(function(){return l})),n.d(t,"queryIsBlockquoteActive",(function(){return h})),n.d(t,"wrapInBlockquote",(function(){return m}));var r=n(147),o=n(143),i=n(145),a=n(149),c=n(141),u=function(e){void 0===e&&(e={});return{type:"node",name:f,schema:{content:"block*",group:"block",defining:!0,draggable:!1,parseDOM:[{tag:"blockquote"}],toDOM:function(){return["blockquote",0]}},markdown:{toMarkdown:function(e,t){e.wrapBlock("> ",null,t,(function(){return e.renderContent(t)}))},parseMarkdown:{blockquote:{block:f}}}}},s=function(e){var t=void 0===e?{}:e,n=t.markdownShortcut,o=void 0===n||n,u=t.keybindings,s=void 0===u?l:u;return function(e){var t,n=e.schema,u=p(n),d=h();return[o&&Object(r.e)(/^\s*>\s$/,u),s&&Object(i.b)((t={},t[s.wrapIn]=m(),t[s.moveUp]=Object(a.c)(u,"UP"),t[s.moveDown]=Object(a.c)(u,"DOWN"),t[s.emptyCopy]=Object(a.a)(u),t[s.emptyCut]=Object(a.b)(u),t[s.insertEmptyParaAbove]=Object(c.a)(d,Object(c.h)(n.nodes.paragraph,"above",!0)),t[s.insertEmptyParaBelow]=Object(c.a)(d,Object(c.h)(n.nodes.paragraph,"below",!0)),t))]}},d={queryIsBlockquoteActive:h,wrapInBlockquote:m},l={wrapIn:"Ctrl-ArrowRight",moveDown:"Alt-ArrowDown",moveUp:"Alt-ArrowUp",emptyCopy:"Mod-c",emptyCut:"Mod-x",insertEmptyParaAbove:"Mod-Shift-Enter",insertEmptyParaBelow:"Mod-Enter"},f="blockquote",p=function(e){return e.nodes[f]};function h(){return function(e){var t=p(e.schema);return Boolean(Object(c.d)(t)(e.selection))}}function m(){return Object(c.a)((function(e){return!h()(e)}),(function(e,t,n){var r=p(e.schema);return Object(o.g)(r)(e,t,n)}))}},177:function(e,t,n){"use strict";n.r(t),n.d(t,"spec",(function(){return c})),n.d(t,"plugins",(function(){return u})),n.d(t,"commands",(function(){return s})),n.d(t,"defaultKeys",(function(){return d})),n.d(t,"toggleBulletList",(function(){return f})),n.d(t,"toggleTodoList2",(function(){return p})),n.d(t,"toggleTodoList",(function(){return h})),n.d(t,"queryIsBulletListActive",(function(){return m})),n.d(t,"queryIsTodoListActive",(function(){return b}));var r=n(145),o=n(147),i=n(149),a=n(167),c=function(e){void 0===e&&(e={});return{type:"node",name:l,schema:{content:"listItem+",group:"block",parseDOM:[{tag:"ul"}],toDOM:function(){return["ul",0]}},markdown:{toMarkdown:function(e,t){e.renderList(t,"  ",(function(){return"- "}))},parseMarkdown:{bullet_list:{block:l}}}}},u=function(e){var t=void 0===e?{}:e,n=t.markdownShortcut,i=void 0===n||n,c=t.todoMarkdownShortcut,u=void 0===c||c,s=t.keybindings,f=void 0===s?d:s;return function(e){var t,n=e.schema,c=function(e){return e.nodes[l]}(n);return[f&&Object(r.b)((t={},t[f.toggle]=Object(a.g)(c,n.nodes.listItem),t[f.toggleTodo]=h(),t)),i&&Object(o.e)(/^\s*([-+*])\s$/,c),u&&Object(o.e)(/^\s*(\[ \])\s$/,n.nodes.listItem,{todoChecked:!1})]}},s={toggleBulletList:f,queryIsBulletListActive:m},d={toggle:"Shift-Ctrl-8",toggleTodo:"Shift-Ctrl-7"},l="bulletList";function f(){return function(e,t,n){return Object(a.g)(e.schema.nodes.bulletList,e.schema.nodes.listItem)(e,t,n)}}function p(){return function(e,t,n){return Object(a.g)(e.schema.nodes.bulletList,e.schema.nodes.listItem,!0)(e,t,n)}}function h(){return function(e,t,n){if(!f()(e,t,n))return!1;var r=(e=n.state).selection,o=r.$from.node(-2),i=r.$to.node(-2);if(!o||o.type.name!==e.schema.nodes.bulletList.name||!i||i.type.name!==e.schema.nodes.bulletList.name)return!0;var a=r.$from.start(-2),c=r.$to.end(-2),u=r.$from.node(-2),s=e.tr;return s.doc.nodesBetween(a,c,(function(e,t){return u===e||("listItem"===e.type.name&&null==e.attrs.todoChecked&&(s=s.setNodeMarkup(t,void 0,Object.assign({},e.attrs,{todoChecked:!1}))),!1)})),t&&t(s),!0}}function m(){return function(e){var t=e.schema;return Object(i.d)(t.nodes.listItem,[t.nodes.bulletList])(e)}}function b(){return function(e){var t=e.schema;return Object(i.d)(t.nodes.listItem,[t.nodes.bulletList])(e)&&"boolean"==typeof e.selection.$from.node(-1).attrs.todoChecked}}},178:function(e,t,n){"use strict";n.r(t),n.d(t,"spec",(function(){return c})),n.d(t,"plugins",(function(){return u})),n.d(t,"commands",(function(){return s})),n.d(t,"defaultKeys",(function(){return d})),n.d(t,"toggleOrderedList",(function(){return f})),n.d(t,"queryIsOrderedListActive",(function(){return p}));var r=n(167),o=n(147),i=n(145),a=n(149),c=function(e){void 0===e&&(e={});return{type:"node",name:l,schema:{attrs:{order:{default:1}},content:"listItem+",group:"block",parseDOM:[{tag:"ol",getAttrs:function(e){return{order:e.hasAttribute("start")?+e.getAttribute("start"):1}}}],toDOM:function(e){return 1===e.attrs.order?["ol",0]:["ol",{start:e.attrs.order},0]}},markdown:{toMarkdown:function(e,t){var n=t.attrs.order||1,r=String(n+t.childCount-1).length,o=e.repeat(" ",r+2);e.renderList(t,o,(function(t){var o=String(n+t);return e.repeat(" ",r-o.length)+o+". "}))},parseMarkdown:{ordered_list:{block:l}}}}},u=function(e){var t=(void 0===e?{}:e).keybindings,n=void 0===t?d:t;return function(e){var t,a=function(e){return e.nodes[l]}(e.schema);return[Object(o.e)(/^(1)[\.\)] $/,a,(function(e){return{order:+e[1]}}),(function(e,t){return t.childCount+t.attrs.order===+e[1]})),n&&Object(i.b)((t={},t[n.toggle]=Object(r.g)(a),t))]}},s={},d={toggle:"Shift-Ctrl-9"},l="orderedList";function f(){return function(e,t,n){return Object(r.g)(e.schema.nodes.orderedList,e.schema.nodes.listItem)(e,t,n)}}function p(){return function(e){var t=e.schema;return Object(a.d)(t.nodes.listItem,[t.nodes[l]])(e)}}},179:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(146);function o(e,t){var n=void 0===t?{}:t,o=n.tag,i=void 0===o?"div":o,a=n.content,c=n.ignoreAttrs,u=void 0===c?[]:c,s=n.parsingPriority,d=function(e){return JSON.stringify(Object(r.f)(e.attrs||{},(function(e,t){return!u.includes(t)})))};return{toDOM:function(t){var n=[i,{"data-bangle-name":e,"data-bangle-attrs":d(t)}];return void 0!==a&&("function"==typeof a?n.push(a(t)):n.push(a)),n},parseDOM:[{priority:void 0===s?51:s,tag:i+'[data-bangle-name="'+e+'"]',getAttrs:function(e){var t=e.getAttribute("data-bangle-attrs");return t?JSON.parse(t):{}}}]}}},180:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(146),o=n(148);function i(){var e=new WeakMap;return{get:function(t,n){a(t);var o=e.get(t);if(!o||!o[n]||!n)throw Object(r.b)("There is no key named "+n+" associated with the pluginKey =",t,"\nPlease make sure you are passing the pluginKey correctly to your components."),new Error("Cannot find the pluginKey '"+n+"'");return e.get(t)[n]},create:function(t,n){a(t);var r=new o.c(n);if(e.has(t)){var i=e.get(t);if(i[n])return i[n];i[n]=r}else{var c;e.set(t,((c={})[n]=r,c))}return r}}}function a(e){if(!(e instanceof o.c))throw Object(r.b)("The key is not a valid pluginKey",e),new Error("Please pass a valid plugin key")}},181:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(4),o=function(e){function t(){return e.apply(this,arguments)||this}return Object(r.a)(t,e),t}(n(142).Selection)},182:function(e,t,n){"use strict";var r=n(0),o=n.n(r),i=n(197),a=n(170),c=n(54),u=n.n(c),s=37,d=39;t.a=function(e){var t=e.lazy,n=e.block,c=e.children,l=e.defaultValue,f=e.values,p=e.groupId,h=e.className,m=Object(i.a)(),b=m.tabGroupChoices,v=m.setTabGroupChoices,g=Object(r.useState)(l),O=g[0],y=g[1];if(null!=p){var w=b[p];null!=w&&w!==O&&f.some((function(e){return e.value===w}))&&y(w)}var j=function(e){y(e),null!=p&&v(p,e)},k=[];return o.a.createElement("div",null,o.a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:Object(a.a)("tabs",{"tabs--block":n},h)},f.map((function(e){var t=e.value,n=e.label;return o.a.createElement("li",{role:"tab",tabIndex:0,"aria-selected":O===t,className:Object(a.a)("tabs__item",u.a.tabItem,{"tabs__item--active":O===t}),key:t,ref:function(e){return k.push(e)},onKeyDown:function(e){!function(e,t,n){switch(n.keyCode){case d:!function(e,t){var n=e.indexOf(t)+1;e[n]?e[n].focus():e[0].focus()}(e,t);break;case s:!function(e,t){var n=e.indexOf(t)-1;e[n]?e[n].focus():e[e.length-1].focus()}(e,t)}}(k,e.target,e)},onFocus:function(){return j(t)},onClick:function(){j(t)}},n)}))),t?Object(r.cloneElement)(c.filter((function(e){return e.props.value===O}))[0],{className:"margin-vert--md"}):o.a.createElement("div",{className:"margin-vert--md"},c.map((function(e,t){return Object(r.cloneElement)(e,{key:t,hidden:e.props.value!==O})}))))}},183:function(e,t,n){"use strict";var r=n(3),o=n(0),i=n.n(o);t.a=function(e){var t=e.children,n=e.hidden,o=e.className;return i.a.createElement("div",Object(r.a)({role:"tabpanel"},{hidden:n,className:o}),t)}},191:function(e,t,n){"use strict";n.d(t,"b",(function(){return k})),n.d(t,"a",(function(){return M})),n.d(t,"c",(function(){return A})),n.d(t,"e",(function(){return D})),n.d(t,"d",(function(){return E}));var r=n(0),o=n.n(r),i=n(23),a=n.n(i),c=n(1),u=n.n(c),s=n(163),d=n(156),l=n(160),f=n(4),p=n(146),h=n(196),m=n(212),b=function(){},v=function(e){function t(t){var n;return(n=e.call(this,t)||this).update=function(){n.setState((function(e,t){return{nodeViewProps:t.nodeView.getNodeViewProps()}}))},n.attachToContentDOM=function(e){if(e){var t=n.props.nodeView.contentDOM;e.contains(t)||(t.parentNode&&t.parentNode.removeChild(t),e.appendChild(t))}},t.nodeViewUpdateStore.set(t.nodeView,n.update),n.state={nodeViewProps:n.props.nodeView.getNodeViewProps()},n}Object(f.a)(t,e);var n=t.prototype;return n.getChildren=function(){return this.props.nodeView.contentDOM?this.state.nodeViewProps.node.isInline?o.a.createElement("span",{className:"bangle-nv-child-container",ref:this.attachToContentDOM}):o.a.createElement("div",{className:"bangle-nv-child-container",ref:this.attachToContentDOM}):null},n.render=function(){b("react rendering",s.a.get(this.props.nodeView));var e=this.props.renderNodeViews(Object.assign({},this.state.nodeViewProps,{children:this.getChildren()}));if(!e)throw Object(p.b)("renderNodeView prop must return a react element for the node",this.state.nodeViewProps.node),new Error('renderNodeView must handle rendering for node of type "'+this.state.nodeViewProps.node.type.name+'"');return e},t}(o.a.PureComponent);v.propTypes={nodeView:u.a.object.isRequired,renderNodeViews:u.a.func.isRequired,nodeViewUpdateStore:u.a.instanceOf(WeakMap).isRequired};var g={selected:u.a.bool.isRequired,node:u.a.instanceOf(h.c).isRequired,view:u.a.instanceOf(m.c).isRequired,getPos:u.a.func.isRequired,decorations:u.a.object.isRequired,attrs:u.a.object.isRequired,updateAttrs:u.a.func.isRequired},O=(Object.assign({},g,{children:u.a.oneOfType([u.a.element,u.a.arrayOf(u.a.element)]).isRequired}),function(){}),y=new WeakMap,w=function(e){return{create:function(t,n){O("create",s.a.get(t)),e((function(e){return[].concat(e,[t])}))},update:function(e,t){O("update",s.a.get(e));var n=y.get(e);n&&n()},destroy:function(t){O("destroy",s.a.get(t)),e((function(e){return e.filter((function(e){return e!==t}))}))}}};var j=function(){},k=o.a.createContext();function M(e){var t=e.id,n=e.state,i=e.children,c=e.focusOnInit,u=void 0===c||c,f=e.pmViewOpts,p=e.renderNodeViews,h=e.onReady,m=void 0===h?function(){}:h,b=Object(r.useRef)(),g=Object(r.useRef)(m),O=Object(r.useRef)({state:n,focusOnInit:u,pmViewOpts:f}),j=Object(r.useState)([]),M=j[0],S=j[1],A=Object(r.useState)(),D=A[0],E=A[1];return Object(r.useEffect)((function(){var e=!1;Object(l.b)(b.current,w((function(t){e||S((function(e){return t(e)}))})));var t=new d.a(b.current,O.current);return t.view._updatePluginWatcher=C(t),g.current(t),E(t),function(){e=!0,t.destroy()}}),[]),o.a.createElement(o.a.Fragment,null,o.a.createElement("div",{ref:b,id:t}),M.map((function(e){return a.a.createPortal(o.a.createElement(v,{debugKey:s.a.get(e),nodeViewUpdateStore:y,nodeView:e,renderNodeViews:p}),e.containerDOM,s.a.get(e))})),D?o.a.createElement(k.Provider,{value:D.view},i):null)}var C=function(e){return function(t,n){if(void 0===n&&(n=!1),!e.destroyed){var r=e.view.state,o=n?r.plugins.filter((function(e){return e!==t})):[].concat(r.plugins,[t]);r=r.reconfigure({plugins:o}),j("Adding watching to existing state",t),e.view.updateState(r)}}};M.propTypes={id:u.a.string,renderNodeViews:u.a.func,onReady:u.a.func,children:u.a.oneOfType([u.a.element,u.a.arrayOf(u.a.element)]),state:u.a.instanceOf(d.b).isRequired,pmViewOpts:u.a.object};n(161),n(162);var S=function(){};function A(e){if(e.plugins&&"function"!=typeof e.plugins)throw new Error("plugins error: plugins must be a function");return Object(r.useState)((function(){return new d.b(e)}))[0]}function D(e,t){void 0===t&&(t=!1);var n=E(),o=Object(r.useState)(e.getState(n.state)),i=o[0],a=o[1];return Object(r.useEffect)((function(){S("Setup plugin",e);var r=a;t&&(r=Object(p.i)(a));var o=function(e,t){return new d.d({key:new d.e("withPluginState_"+e.key),view:function(){return{update:function(n,r){var o=n.state;if(r!==o){var i=e.getState(o);i!==e.getState(r)&&t(i)}}}}})}(e,r);return n._updatePluginWatcher(o),function(){t&&r.cancel(),n._updatePluginWatcher(o,!0)}}),[n,e,t]),i}function E(){return Object(r.useContext)(k)}},193:function(e,t,n){"use strict";n.d(t,"b",(function(){return f})),n.d(t,"a",(function(){return h})),n.d(t,"c",(function(){return b}));var r=n(4),o=n(0),i=n.n(o),a=n(1),c=n.n(a),u=n(198),s=n(182),d=n(183),l=n(199);function f(e){var t=e.filePath,n=e.language,r=e.createEditor,a=e.defaultTab,c=void 0===a?"example":a,u=e.onEditorReady,s=void 0===u?function(){}:u,d=e.SideCar,l=Object(o.useRef)(r),f=Object(o.useState)(!1),m=f[0],b=f[1],v=Object(o.useCallback)((function(){return i.a.createElement(p,{createEditor:l.current,onReady:b})}),[l,b]);return i.a.createElement(i.a.Fragment,null,i.a.createElement(h,{filePath:t,language:n,component:v,defaultTab:c}),m?s(m):null,m&&d?i.a.createElement(d,{editor:m}):null)}function p(e){var t=e.createEditor,n=e.onReady,r=Object(o.useRef)();return Object(o.useEffect)((function(){var e=t(r.current);return n(e),function(){e.destroy()}}),[t,n]),i.a.createElement("div",{ref:r})}function h(e){var t=e.filePath,n=e.language,r=e.component,o=e.defaultTab,a=void 0===o?"example":o;return i.a.createElement(v,null,i.a.createElement(s.a,{defaultValue:a,values:[{label:"Example",value:"example"},{label:"Source code",value:"src"}]},i.a.createElement(d.a,{value:"example"},i.a.createElement(l.a,null,r)),i.a.createElement(d.a,{value:"src"},i.a.createElement(m,{filePath:t,language:n}))))}function m(e){var t=e.filePath,n=e.language,r=void 0===n?"js":n,a=Object(o.useState)(),c=a[0],s=a[1];return Object(o.useEffect)((function(){var e=!1;return function(e){return fetch(e).then((function(e){return e.text()}))}(t).then((function(t){e||s(t)})).catch((function(n){console.error(n),e||s("Error: Could not load source code at "+t)})),function(){e=!0}}),[s,t]),c?i.a.createElement(u.a,{className:"language-"+r},c):"loading..."}function b(e){var t="",n="";return e.split(/>\s*</).forEach((function(e){e.match(/^\/\w/)&&(n=n.substring("  ".length)),t+=n+"<"+e+">\r\n",e.match(/^<?\w[^>]*[^\/]$/)&&(n+="  ")})),t.substring(1,t.length-3)}h.propTypes={component:c.a.func.isRequired,language:c.a.string,filePath:c.a.string.isRequired};var v=function(e){function t(){for(var t,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(t=e.call.apply(e,[this].concat(r))||this).state={hasError:!1},t}return Object(r.a)(t,e),t.getDerivedStateFromError=function(e){return{hasError:!0}},t.prototype.render=function(){return this.state.hasError?i.a.createElement("div",{style:{margin:"2rem 2rem",padding:"1rem 2rem",backgroundColor:"red",color:"white"}},"Whoops! There was an error loading this example, please file a github issue to report it"):this.props.children},t}(i.a.PureComponent)},196:function(e,t,n){"use strict";var r=n(144);n.d(t,"c",(function(){return r.Node})),n.d(t,"b",(function(){return r.Fragment})),n.d(t,"a",(function(){return r.DOMSerializer}))},212:function(e,t,n){"use strict";var r=n(185);n.d(t,"a",(function(){return r.a})),n.d(t,"b",(function(){return r.b})),n.d(t,"c",(function(){return r.c}))}}]);